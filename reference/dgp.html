<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function builds and trains a DGP emulator."><title>Deep Gaussian process emulator construction — dgp • dgpsi</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Deep Gaussian process emulator construction — dgp"><meta property="og:description" content="This function builds and trains a DGP emulator."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dgpsi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/dgpsi.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/motorcycle.html">DGP Emulation with the Heteroskedastic Gaussian Likelihood 
</a>
    <a class="dropdown-item" href="../articles/linked_DGP.html">Linked (D)GP Emulation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mingdeyu/dgpsi-R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Deep Gaussian process emulator construction</h1>
      <small class="dont-index">Source: <a href="https://github.com/mingdeyu/dgpsi-R/blob/HEAD/R/dgp.R" class="external-link"><code>R/dgp.R</code></a></small>
      <div class="d-none name"><code>dgp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function builds and trains a DGP emulator.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dgp</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  struc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  depth <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"sexp"</span>,</span>
<span>  lengthscale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nugget_est <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nugget <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  connect <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  likelihood <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verb <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  check_rep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rff <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  M <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  ess_burn <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  burnin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  internal_input_idx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  linked_idx <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>X</dt>
<dd><p>a matrix where each row is an input training data point and each column is an input dimension.</p></dd>


<dt>Y</dt>
<dd><p>a matrix containing observed training output data. The matrix has it rows being output data points and columns being
output dimensions. When <code>likelihood</code> (see below) is not <code>NULL</code>, <code>Y</code> must be a matrix with only one column.</p></dd>


<dt>struc</dt>
<dd><p>a list that specifies a user-defined DGP structure. It should contain <em>L</em> (the number of DGP layers) sub-lists,
each of which represents a layer and contains a number of GP nodes (defined by <code><a href="kernel.html">kernel()</a></code>) in the corresponding layer.
The final layer of the DGP structure (i.e., the final sub-list in <code>struc</code>) can be a likelihood
layer that contains a likelihood function (e.g., <code><a href="Poisson.html">Poisson()</a></code>). When <code>struc = NULL</code>,
the DGP structure is automatically generated and will be summarized in a table after <code>dgp()</code> is executed if <code>verb</code> (see below) is set to <code>2</code>.
If this argument is used (i.e., user provides a customized DGP structure), arguments <code>depth</code>, <code>name</code>, <code>lengthscale</code>, <code>nugget_est</code>, <code>nugget</code>,
<code>connect</code>, <code>likelihood</code>, and <code>internal_input_idx</code> will NOT be used. Defaults to <code>NULL</code>.</p></dd>


<dt>depth</dt>
<dd><p>number of layers (including the likelihood layer) for a DGP structure. <code>depth</code> must be at least <code>2</code>.
Defaults to <code>2</code>. This argument is only used when <code>struc = NULL</code>.</p></dd>


<dt>name</dt>
<dd><p>kernel function to be used. Either <code>"sexp"</code> for squared exponential kernel or
<code>"matern2.5"</code> for Matérn-2.5 kernel. Defaults to <code>"sexp"</code>. This argument is only used when <code>struc = NULL</code>.</p></dd>


<dt>lengthscale</dt>
<dd><p>initial lengthscales for GP nodes in the DGP emulator. It can be a single numeric value or a vector:</p><ol><li><p>if it is a single numeric value, the value will be applied as the initial lengthscales for all GP nodes in the DGP hierarchy.</p></li>
<li><p>if it is a vector, each element of the vector specifies the initial lengthscales that will be applied to all GP nodes in the corresponding layer.
The vector should have a length of <code>depth</code> if <code>likelihood = NULL</code> or a length of <code>depth - 1</code> if <code>likelihood</code> is not <code>NULL</code>.</p></li>
</ol><p>Defaults to a numeric value of <code>1.0</code>. This argument is only used when <code>struc = NULL</code>.</p></dd>


<dt>nugget_est</dt>
<dd><p>a bool or a bool vector that indicates if the nuggets of GP nodes (if any) in the final layer are to be estimated. If a single bool is
provided, it will be applied to all GP nodes (if any) in the final layer. If a bool vector (which must have a length of <code>ncol(Y)</code>) is provided, each
bool element in the vector will be applied to the corresponding GP node (if any) in the final layer. The value of a bool has following effects:</p><ul><li><p><code>FALSE</code>: the nugget of the corresponding GP in the final layer is fixed to the corresponding value defined in <code>nugget</code> (see below).</p></li>
<li><p><code>TRUE</code>: the nugget of the corresponding GP in the final layer will be estimated with the initial value given by the correspondence in <code>nugget</code> (see below).</p></li>
</ul><p>Defaults to <code>FALSE</code>. This argument is only used when <code>struc = NULL</code>.</p></dd>


<dt>nugget</dt>
<dd><p>the initial nugget value(s) of GP nodes (if any) in the final layer. If it is a single numeric value, it will be applied to all GP nodes (if any)
in the final layer. If it is a vector (which must have a length of <code>ncol(Y)</code>), each numeric in the vector will be applied to the corresponding GP node
(if any) in the final layer. Set <code>nugget</code> to a small value and the corresponding bool in <code>nugget_est</code> to <code>FASLE</code> for deterministic emulations where the emulator
interpolates the training data points. Set <code>nugget</code> to a reasonable larger value and the corresponding bool in <code>nugget_est</code> to <code>TRUE</code> for stochastic emulations where
the computer model outputs are assumed to follow a homogeneous Gaussian distribution. Defaults to <code>1e-6</code>. This argument is only used when <code>struc = NULL</code>.</p></dd>


<dt>connect</dt>
<dd><p>a bool indicating whether to implement global input connection to the DGP structure. Defaults to <code>TRUE</code>.
This argument is only used when <code>struc = NULL</code>.</p></dd>


<dt>likelihood</dt>
<dd><p>the likelihood type of a DGP emulator:</p><ol><li><p><code>NULL</code>: no likelihood layer is included in the emulator.</p></li>
<li><p><code>"Hetero"</code>: a heteroskedastic likelihood layer is added for stochastic emulation where the computer model outputs are assumed to follow a heteroskedastic Gaussian distribution
(i.e., the computer model outputs have varying noises).</p></li>
<li><p><code>"Poisson"</code>: a Poisson likelihood layer is added for stochastic emulation where the computer model outputs are assumed to a Poisson distribution.</p></li>
<li><p><code>"NegBin"</code>: a negative Binomial likelihood layer is added for stochastic emulation where the computer model outputs are assumed to follow a negative Binomial distribution.</p></li>
</ol><p>When <code>likelihood</code> is not <code>NULL</code>, the values of <code>nugget_est</code> and <code>nugget</code> are overridden by <code>FALSE</code> and <code>1e-6</code> respectively. Defaults to <code>NULL</code>. This argument is only used when <code>struc = NULL</code>.</p></dd>


<dt>verb</dt>
<dd><p>an integer indicating the level of information to be printed during the function execution:</p><ul><li><p><code>2</code>: trace information on DGP initialization and a summary table of the initialized DGP emulator.</p></li>
<li><p><code>1</code>: all information as in <code>2</code> except for the summary table.</p></li>
<li><p><code>0</code>: no trace information and the summary table.</p></li>
</ul><p>When <code>verb = 2</code>, you will have a chance to check the specified DGP emulator (especially when a customized <code>struc</code> is provided) and decide if you want to proceed to training. Defaults to <code>1</code>.</p></dd>


<dt>check_rep</dt>
<dd><p>a bool indicating whether to check the repetitions in the dataset, i.e., if one input
position has multiple outputs. Defaults to <code>TRUE</code>.</p></dd>


<dt>rff</dt>
<dd><p>a bool indicating whether to use random Fourier features to approximate the correlation matrices in training. Turning on this option could help accelerate
the training when the training data is relatively large but may reduce the quality of the resulting emulator. Defaults to <code>FALSE</code>.</p></dd>


<dt>M</dt>
<dd><p>the number of features to be used by random Fourier approximation. It is only used
when <code>rff</code> is set to <code>TRUE</code>. Defaults to <code>NULL</code>. If it is <code>NULL</code>, <code>M</code> is automatically set to
<code>max(100, ceiling(sqrt(nrow(X))*log(nrow(X)))))</code>.</p></dd>


<dt>N</dt>
<dd><p>number of iterations for the training. Defaults to <code>500</code>.</p></dd>


<dt>ess_burn</dt>
<dd><p>number of burnin steps for the ESS-within-Gibbs
at each I-step of the training. Defaults to <code>10</code>.</p></dd>


<dt>burnin</dt>
<dd><p>the number of training iterations to be discarded for
point estimate calculation. Must be smaller than the SEM iterations
implemented. If this is not specified, only the last 25% of iterations
are used. Defaults to <code>NULL</code>.</p></dd>


<dt>B</dt>
<dd><p>the number of imputations to produce the later predictions. Increase the value to account for
more imputation uncertainties. Decrease the value for lower imputation uncertainties but faster predictions.
Defaults to <code>50</code>.</p></dd>


<dt>internal_input_idx</dt>
<dd><p>column indices of <code>X</code> that are generated by the linked emulators in the feeding layer.
Set <code>internal_input_idx = NULL</code> if the DGP emulator is not linked to any emulator (e.g., the DGP emulator
is in the first layer of a system) or all columns in <code>X</code> are generated by the linked emulators in the feeding layer.
Defaults to <code>NULL</code>. This argument is only used when <code>struc = NULL</code>.</p></dd>


<dt>linked_idx</dt>
<dd><p>indices of columns in the pooled output matrix (formed by column-combined outputs of all emulators
in the feeding layer) that will feed into the DGP emulator. The length of <code>linked_idx</code> shall equal to the length of
<code>internal_input_idx</code> when <code>internal_input_idx</code> is not <code>NULL</code>. Set <code>linked_idx = NULL</code> if the DGP emulator is not intended
for linked emulations. If the DGP emulator is in the first layer of a system, <code>linked_idx</code> gives the column indices of the
global input (formed by column-combining all input matrices of emulators in the first layer) that the DGP emulator will use.
Defaults to <code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An S3 class named <code>dgp</code> that can be used by</p><ul><li><p><code><a href="predict.html">predict()</a></code> for DGP predictions.</p></li>
<li><p><code><a href="continue.html">continue()</a></code> to implement additional DGP training iterations.</p></li>
<li><p><code><a href="lgp.html">lgp()</a></code> to construct linked (D)GP emulators.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See examples in Articles at <a href="https://mingdeyu.github.io/dgpsi-R/" class="external-link">https://mingdeyu.github.io/dgpsi-R/</a> and learn how to customize a DGP structure.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Deyu Ming.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

