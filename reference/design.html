<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sequential design of a (D)GP emulator or a bundle of (D)GP emulators — design • dgpsi</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sequential design of a (D)GP emulator or a bundle of (D)GP emulators — design"><meta name="description" content="
This function implements sequential design and active learning for a (D)GP emulator or
a bundle of (D)GP emulators, supporting an array of popular methods as well as user-specified approaches.
It can also be used as a wrapper for Bayesian optimization methods."><meta property="og:description" content="
This function implements sequential design and active learning for a (D)GP emulator or
a bundle of (D)GP emulators, supporting an array of popular methods as well as user-specified approaches.
It can also be used as a wrapper for Bayesian optimization methods."><meta property="og:image" content="http://mingdeyu.github.io/dgpsi-R/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dgpsi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dgpsi.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/large_scale_emulation.html">Large-Scale DGP Emulation
    </a></li>
    <li><a class="dropdown-item" href="../articles/linked_DGP.html">Linked (D)GP Emulation</a></li>
    <li><a class="dropdown-item" href="../articles/motorcycle.html">Non-Gaussian Emulation</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">DGP Classification
    </a></li>
    <li><a class="dropdown-item" href="../articles/seq_design.html">Sequential Design I</a></li>
    <li><a class="dropdown-item" href="../articles/seq_design_2.html">Sequential Design II</a></li>
    <li><a class="dropdown-item" href="../articles/bayes_opt.html">Bayesian Optimization</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mingdeyu/dgpsi-R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sequential design of a (D)GP emulator or a bundle of (D)GP emulators</h1>
      <small class="dont-index">Source: <a href="https://github.com/mingdeyu/dgpsi-R/blob/v2.5.0/R/design.R" class="external-link"><code>R/design.R</code></a></small>
      <div class="d-none name"><code>design.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#updated" class="external-link"><img src="figures/lifecycle-updated.svg" alt="[Updated]"></a></p>
<p>This function implements sequential design and active learning for a (D)GP emulator or
a bundle of (D)GP emulators, supporting an array of popular methods as well as user-specified approaches.
It can also be used as a wrapper for Bayesian optimization methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">design</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">N</span>,</span>
<span>  <span class="va">x_cand</span>,</span>
<span>  <span class="va">y_cand</span>,</span>
<span>  <span class="va">n_sample</span>,</span>
<span>  <span class="va">n_cand</span>,</span>
<span>  <span class="va">limits</span>,</span>
<span>  <span class="va">f</span>,</span>
<span>  <span class="va">reps</span>,</span>
<span>  <span class="va">freq</span>,</span>
<span>  <span class="va">x_test</span>,</span>
<span>  <span class="va">y_test</span>,</span>
<span>  <span class="va">reset</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  <span class="va">batch_size</span>,</span>
<span>  <span class="va">eval</span>,</span>
<span>  <span class="va">verb</span>,</span>
<span>  <span class="va">autosave</span>,</span>
<span>  <span class="va">new_wave</span>,</span>
<span>  <span class="va">M_val</span>,</span>
<span>  <span class="va">cores</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'gp'</span></span>
<span><span class="fu">design</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">N</span>,</span>
<span>  x_cand <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_cand <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_sample <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  n_cand <span class="op">=</span> <span class="fu">lifecycle</span><span class="fu">::</span><span class="fu"><a href="https://lifecycle.r-lib.org/reference/deprecated.html" class="external-link">deprecated</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  f <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  x_test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reset <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  target <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="va">vigf</span>,</span>
<span>  batch_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  eval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verb <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  autosave <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  new_wave <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  M_val <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'dgp'</span></span>
<span><span class="fu">design</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">N</span>,</span>
<span>  x_cand <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_cand <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_sample <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  n_cand <span class="op">=</span> <span class="fu">lifecycle</span><span class="fu">::</span><span class="fu"><a href="https://lifecycle.r-lib.org/reference/deprecated.html" class="external-link">deprecated</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  f <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  x_test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reset <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  target <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="va">vigf</span>,</span>
<span>  batch_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  eval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verb <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  autosave <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  new_wave <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  M_val <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  train_N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  refit_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pruning <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'bundle'</span></span>
<span><span class="fu">design</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">N</span>,</span>
<span>  x_cand <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_cand <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_sample <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  n_cand <span class="op">=</span> <span class="fu">lifecycle</span><span class="fu">::</span><span class="fu"><a href="https://lifecycle.r-lib.org/reference/deprecated.html" class="external-link">deprecated</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  f <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  x_test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reset <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  target <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="va">vigf</span>,</span>
<span>  batch_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  eval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verb <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  autosave <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  new_wave <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  M_val <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  train_N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  refit_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>can be one of the following:</p><ul><li><p>the S3 class <code>gp</code>.</p></li>
<li><p>the S3 class <code>dgp</code>.</p></li>
<li><p>the S3 class <code>bundle</code>.</p></li>
</ul></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>the number of iterations for the sequential design.</p></dd>


<dt id="arg-x-cand">x_cand<a class="anchor" aria-label="anchor" href="#arg-x-cand"></a></dt>
<dd><p>a matrix (with each row being a design point and column being an input dimension) that gives a candidate set
from which the next design points are determined. Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-y-cand">y_cand<a class="anchor" aria-label="anchor" href="#arg-y-cand"></a></dt>
<dd><p>a matrix (with each row being a simulator evaluation and column being an output dimension) that gives the realizations
from the simulator at input positions in <code>x_cand</code>. Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-n-sample">n_sample<a class="anchor" aria-label="anchor" href="#arg-n-sample"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#new" class="external-link"><img src="figures/lifecycle-new.svg" alt="[New]"></a> an integer that gives the size of a sub-set to be sampled from the candidate set <code>x_cand</code> at each step of the sequential design to determine the next
design point, if <code>x_cand</code> is not <code>NULL</code>.</p>
<p>Defaults to <code>200</code>.</p></dd>


<dt id="arg-n-cand">n_cand<a class="anchor" aria-label="anchor" href="#arg-n-cand"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> this argument is deprecated. Use <code>n_sample</code> instead.</p></dd>


<dt id="arg-limits">limits<a class="anchor" aria-label="anchor" href="#arg-limits"></a></dt>
<dd><p>a two-column matrix that gives the ranges of each input dimension, or a vector of length two if there is only one
input dimension. If a vector is provided, it will be converted to a two-column row matrix. The rows of the matrix correspond to input
dimensions, and its first and second columns correspond to the minimum and maximum values of the input dimensions. Set
<code>limits = NULL</code> if <code>x_cand</code> is supplied. This argument is only used when <code>x_cand</code> is not supplied, i.e., <code>x_cand = NULL</code>. Defaults to <code>NULL</code>. If you provide
a custom <code>method</code> function with an argument called <code>limits</code>, the value of <code>limits</code> will be passed to your function.</p></dd>


<dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>an R function representing the simulator. <code>f</code> must adhere to the following rules:</p><ul><li><p><strong>First argument</strong>: a matrix where rows correspond to different design points, and columns represent input dimensions.</p></li>
<li><p><strong>Function output</strong>:</p><ul><li><p>a matrix where rows correspond to different outputs (matching the input design points) and columns represent output dimensions.
If there is only one output dimension, the function should return a matrix with a single column.</p></li>
<li><p>alternatively, a list where:</p><ul><li><p>the first element is the output matrix as described above.</p></li>
<li><p>additional named elements can optionally update values of arguments with matching names passed via <code>...</code>. This list output is
useful if additional arguments to <code>f</code>, <code>method</code>, or <code>eval</code> need to be updated after each sequential design iteration.</p></li>
</ul></li>
</ul></li>
</ul><p>See the <em>Note</em> section below for additional details. This argument is required and must be supplied when <code>y_cand = NULL</code>. Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-reps">reps<a class="anchor" aria-label="anchor" href="#arg-reps"></a></dt>
<dd><p>an integer that gives the number of repetitions of the located design points to be created and used for evaluations of <code>f</code>. Set the
argument to an integer greater than <code>1</code> only if <code>f</code> is a stochastic function that can generate different responses given for the same input and the
supplied emulator <code>object</code> can deal with stochastic responses, e.g., a (D)GP emulator with <code>nugget_est = TRUE</code> or a DGP emulator with a
likelihood layer. The argument is only used when <code>f</code> is supplied. Defaults to <code>1</code>.</p></dd>


<dt id="arg-freq">freq<a class="anchor" aria-label="anchor" href="#arg-freq"></a></dt>
<dd><p>a vector of two integers with the first element indicating the number of iterations taken between re-estimating
the emulator hyperparameters, and the second element defining the number of iterations to take between re-calculation of evaluating metrics
on the validation set (see <code>x_test</code> below) via the <code>eval</code> function. Defaults to <code>c(1, 1)</code>.</p></dd>


<dt id="arg-x-test">x_test<a class="anchor" aria-label="anchor" href="#arg-x-test"></a></dt>
<dd><p>a matrix (with each row being an input testing data point and each column being an input dimension) that gives the testing
input data to evaluate the emulator after each <code>freq[2]</code> iterations of the sequential design. Set to <code>NULL</code> for LOO-based emulator validation.
Defaults to <code>NULL</code>. This argument is only used if <code>eval = NULL</code>.</p></dd>


<dt id="arg-y-test">y_test<a class="anchor" aria-label="anchor" href="#arg-y-test"></a></dt>
<dd><p>the testing output data corresponding to <code>x_test</code> for emulator validation after each <code>freq[2]</code> iterations of the sequential design:</p><ul><li><p>if <code>object</code> is an instance of the <code>gp</code> class, <code>y_test</code> is a matrix with only one column and each row contains a testing output data point from the corresponding row of <code>x_test</code>.</p></li>
<li><p>if <code>object</code> is an instance of the <code>dgp</code> class, <code>y_test</code> is a matrix with its rows containing testing output data points corresponding to the same rows of <code>x_test</code> and columns representing the
output dimensions.</p></li>
<li><p>if <code>object</code> is an instance of the <code>bundle</code> class, <code>y_test</code> is a matrix with each row representing the outputs for the corresponding row of <code>x_test</code> and each column representing the output of the different emulators in the bundle.</p></li>
</ul><p>Set to <code>NULL</code> for LOO-based emulator validation. Defaults to <code>NULL</code>. This argument is only used if <code>eval = NULL</code>.</p></dd>


<dt id="arg-reset">reset<a class="anchor" aria-label="anchor" href="#arg-reset"></a></dt>
<dd><p>A bool or a vector of bools indicating whether to reset the hyperparameters of the emulator(s) to their initial values (as set during initial construction) before re-fitting.
The re-fitting occurs based on the frequency specified by <code>freq[1]</code>. This option is useful when hyperparameters are suspected to have converged to a local optimum affecting validation performance.</p><ul><li><p>If a single bool is provided, it applies to every iteration of the sequential design.</p></li>
<li><p>If a vector is provided, its length must equal <code>N</code> (even if the re-fit frequency specified in <code>freq[1]</code> is not 1) and it will apply to the corresponding iterations of the sequential design.</p></li>
</ul><p>Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>a number or vector specifying the target evaluation metric value(s) at which the sequential design should terminate.
Defaults to <code>NULL</code>, in which case the sequential design stops after <code>N</code> steps. See the <em>Note</em> section below for further details about <code>target</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#updated" class="external-link"><img src="figures/lifecycle-updated.svg" alt="[Updated]"></a> an R function that determines the next design points to be evaluated by <code>f</code>. The function must adhere to the following rules:</p><ul><li><p><strong>First argument</strong>: an emulator object, which can be one of the following:</p><ul><li><p>an instance of the <code>gp</code> class (produced by <code><a href="gp.html">gp()</a></code>);</p></li>
<li><p>an instance of the <code>dgp</code> class (produced by <code><a href="dgp.html">dgp()</a></code>);</p></li>
<li><p>an instance of the <code>bundle</code> class (produced by <code><a href="pack.html">pack()</a></code>).</p></li>
</ul></li>
<li><p><strong>Second argument</strong> (if <code>x_cand</code> is not <code>NULL</code>): a <em>candidate matrix</em> representing a set of potential design points from which the <code>method</code> function selects the next points.</p></li>
<li><p><strong>Function output</strong>:</p><ul><li><p>If <code>x_cand</code> is not <code>NULL</code>:</p><ul><li><p>for <code>gp</code> or <code>dgp</code> objects, the output must be a vector of row indices corresponding to the selected design points from the <em>candidate matrix</em> (the second argument).</p></li>
<li><p>for <code>bundle</code> objects, the output must be a matrix containing the row indices of the selected design points from the <em>candidate matrix</em>. Each column corresponds to
the indices for an individual emulator in the bundle.</p></li>
</ul></li>
<li><p>If <code>x_cand</code> is <code>NULL</code>:</p><ul><li><p>for <code>gp</code> or <code>dgp</code> objects, the output must be a matrix where each row represents a new design point to be added.</p></li>
<li><p>for <code>bundle</code> objects, the output must be a list with a length equal to the number of emulators in the bundle. Each element in the list is a matrix where rows
represent the new design points for the corresponding emulator.</p></li>
</ul></li>
</ul></li>
</ul><p>See <code><a href="alm.html">alm()</a></code>, <code><a href="mice.html">mice()</a></code>, and <code><a href="vigf.html">vigf()</a></code> for examples of built-in <code>method</code> functions. Defaults to <code><a href="vigf.html">vigf()</a></code>.</p></dd>


<dt id="arg-batch-size">batch_size<a class="anchor" aria-label="anchor" href="#arg-batch-size"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#new" class="external-link"><img src="figures/lifecycle-new.svg" alt="[New]"></a> an integer specifying the number of design points to select in a single iteration. Defaults to <code>1</code>.
This argument is used by the built-in <code>method</code> functions <code><a href="alm.html">alm()</a></code>, <code><a href="mice.html">mice()</a></code>, and <code><a href="vigf.html">vigf()</a></code>.
If you provide a custom <code>method</code> function with an argument named <code>batch_size</code>, the value of <code>batch_size</code> will be passed to your function.</p></dd>


<dt id="arg-eval">eval<a class="anchor" aria-label="anchor" href="#arg-eval"></a></dt>
<dd><p>an R function that computes a customized metric for evaluating emulator performance. The function must adhere to the following rules:</p><ul><li><p><strong>First argument</strong>: an emulator object, which can be one of the following:</p><ul><li><p>an instance of the <code>gp</code> class (produced by <code><a href="gp.html">gp()</a></code>);</p></li>
<li><p>an instance of the <code>dgp</code> class (produced by <code><a href="dgp.html">dgp()</a></code>);</p></li>
<li><p>an instance of the <code>bundle</code> class (produced by <code><a href="pack.html">pack()</a></code>).</p></li>
</ul></li>
<li><p><strong>Function output</strong>:</p><ul><li><p>for <code>gp</code> objects, the output must be a single metric value.</p></li>
<li><p>for <code>dgp</code> objects, the output can be a single metric value or a vector of metric values with a length equal to the number of output dimensions.</p></li>
<li><p>for <code>bundle</code> objects, the output can be a single metric value or a vector of metric values with a length equal to the number of emulators in the bundle.</p></li>
</ul></li>
</ul><p>If no custom function is provided, a built-in evaluation metric (RMSE or log-loss, in the case of DGP emulators with categorical likelihoods) will be used.
Defaults to <code>NULL</code>. See the <em>Note</em> section below for additional details.</p></dd>


<dt id="arg-verb">verb<a class="anchor" aria-label="anchor" href="#arg-verb"></a></dt>
<dd><p>a bool indicating if trace information will be printed during the sequential design.
Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-autosave">autosave<a class="anchor" aria-label="anchor" href="#arg-autosave"></a></dt>
<dd><p>a list that contains configuration settings for the automatic saving of the emulator:</p><ul><li><p><code>switch</code>: a bool indicating whether to enable automatic saving of the emulator during sequential design. When set to <code>TRUE</code>,
the emulator in the final iteration is always saved. Defaults to <code>FALSE</code>.</p></li>
<li><p><code>directory</code>: a string specifying the directory path where the emulators will be stored. Emulators will be stored in a sub-directory
of <code>directory</code> named 'emulator-<code>id</code>'. Defaults to './check_points'.</p></li>
<li><p><code>fname</code>: a string representing the base name for the saved emulator files. Defaults to 'check_point'.</p></li>
<li><p><code>save_freq</code>: an integer indicating the frequency of automatic saves, measured in the number of iterations. Defaults to <code>5</code>.</p></li>
<li><p><code>overwrite</code>: a bool value controlling the file saving behavior. When set to <code>TRUE</code>, each new automatic save overwrites the previous one,
keeping only the latest version. If <code>FALSE</code>, each automatic save creates a new file, preserving all previous versions. Defaults to <code>FALSE</code>.</p></li>
</ul></dd>


<dt id="arg-new-wave">new_wave<a class="anchor" aria-label="anchor" href="#arg-new-wave"></a></dt>
<dd><p>a bool indicating whether the current call to <code>design()</code> will create a new wave of sequential designs or add the next sequence of designs to the most recent wave.
This argument is relevant only if waves already exist in the emulator. Creating new waves can improve the visualization of sequential design performance across different calls
to <code>design()</code> via <code><a href="draw.html">draw()</a></code>, and allows for specifying a different evaluation frequency in <code>freq</code>. However, disabling this option can help limit the number of waves visualized
in <code><a href="draw.html">draw()</a></code> to avoid issues such as running out of distinct colors for large numbers of waves. Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-m-val">M_val<a class="anchor" aria-label="anchor" href="#arg-m-val"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#new" class="external-link"><img src="figures/lifecycle-new.svg" alt="[New]"></a> an integer that gives the size of the conditioning set for the Vecchia approximation in emulator validations. This argument is only used if the emulator <code>object</code>
was constructed under the Vecchia approximation. Defaults to <code>50</code>.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>an integer that gives the number of processes to be used for emulator validation. If set to <code>NULL</code>, the number of processes is set to
<code>max physical cores available %/% 2</code>. Defaults to <code>1</code>. This argument is only used if <code>eval = NULL</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Any arguments with names that differ from those used in <code>design()</code> but are required by <code>f</code>, <code>method</code>, or <code>eval</code> can be passed here.
<code>design()</code> will forward relevant arguments to <code>f</code>, <code>method</code>, and <code>eval</code> based on the names of the additional arguments provided.</p></dd>


<dt id="arg-train-n">train_N<a class="anchor" aria-label="anchor" href="#arg-train-n"></a></dt>
<dd><p>the number of training iterations to be used for re-fitting the DGP emulator at each step of the sequential design:</p><ul><li><p>If <code>train_N</code> is an integer, the DGP emulator will be re-fitted at each step (based on the re-fit frequency specified in <code>freq[1]</code>) using <code>train_N</code> iterations.</p></li>
<li><p>If <code>train_N</code> is a vector, its length must be <code>N</code>, even if the re-fit frequency specified in <code>freq[1]</code> is not 1.</p></li>
<li><p>If <code>train_N</code> is <code>NULL</code>, the DGP emulator will be re-fitted at each step (based on the re-fit frequency specified in <code>freq[1]</code>) using:</p><ul><li><p><code>100</code> iterations if the DGP emulator was constructed without the Vecchia approximation, or</p></li>
<li><p><code>50</code> iterations if the Vecchia approximation was used.</p></li>
</ul></li>
</ul><p>Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-refit-cores">refit_cores<a class="anchor" aria-label="anchor" href="#arg-refit-cores"></a></dt>
<dd><p>the number of processes to be used to re-fit GP components (in the same layer of a DGP emulator)
at each M-step during the re-fitting. If set to <code>NULL</code>, the number of processes is set to <code>(max physical cores available - 1)</code>
if the DGP emulator was constructed without the Vecchia approximation. Otherwise, the number of processes is set to <code>max physical cores available %/% 2</code>.
Only use multiple processes when there is a large number of GP components in different layers and optimization of GP components
is computationally expensive. Defaults to <code>1</code>.</p></dd>


<dt id="arg-pruning">pruning<a class="anchor" aria-label="anchor" href="#arg-pruning"></a></dt>
<dd><p>a bool indicating if dynamic pruning of DGP structures will be implemented during the sequential design after the total number of
design points exceeds <code>min_size</code> in <code>control</code>. The argument is only applicable to DGP emulators (i.e., <code>object</code> is an instance of <code>dgp</code> class)
produced by <code><a href="dgp.html">dgp()</a></code>. Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>a list that can supply any of the following components to control the dynamic pruning of the DGP emulator:</p><ul><li><p><code>min_size</code>, the minimum number of design points required to trigger dynamic pruning. Defaults to 10 times the number of input dimensions.</p></li>
<li><p><code>threshold</code>, the \(R^2\) value above which a GP node is considered redundant. Defaults to <code>0.97</code>.</p></li>
<li><p><code>nexceed</code>, the minimum number of consecutive iterations that the \(R^2\) value of a GP node must exceed <code>threshold</code> to trigger the removal of that node from
the DGP structure. Defaults to <code>3</code>.</p></li>
</ul><p>The argument is only used when <code>pruning = TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An updated <code>object</code> is returned with a slot called <code>design</code> that contains:</p><ul><li><p><em>S</em> slots, named <code>wave1, wave2,..., waveS</code>, that contain information of <em>S</em> waves of sequential design that have been applied to the emulator.
Each slot contains the following elements:</p><ul><li><p><code>N</code>, an integer that gives the numbers of iterations implemented in the corresponding wave;</p></li>
<li><p><code>rmse</code>, a matrix providing the evaluation metric values for emulators constructed during the corresponding wave, when <code>eval = NULL</code>.
Each row of the matrix represents an iteration.</p><ul><li><p>for an <code>object</code> of class <code>gp</code>, the matrix contains a single column of RMSE values.</p></li>
<li><p>for an <code>object</code> of class <code>dgp</code> without a categorical likelihood, each row contains mean/median squared errors corresponding to different output dimensions.</p></li>
<li><p>for an <code>object</code> of class <code>dgp</code> with a categorical likelihood, the matrix contains a single column of log-loss values.</p></li>
<li><p>for an <code>object</code> of class <code>bundle</code>, each row contains either mean/median squared errors or log-loss values for the emulators in the bundle.</p></li>
</ul></li>
<li><p><code>metric</code>: a matrix providing the values of custom evaluation metrics, as computed by the user-supplied <code>eval</code> function, for emulators constructed during the corresponding wave.</p></li>
<li><p><code>freq</code>, an integer that gives the frequency that the emulator validations are implemented during the corresponding wave.</p></li>
<li><p><code>enrichment</code>, a vector of size <code>N</code> that gives the number of new design points added after each step of the sequential design (if <code>object</code> is
an instance of the <code>gp</code> or <code>dgp</code> class), or a matrix that gives the number of new design points added to emulators in a bundle after each step of
the sequential design (if <code>object</code> is an instance of the <code>bundle</code> class).</p></li>
</ul><p>If <code>target</code> is not <code>NULL</code>, the following additional elements are also included:</p><ul><li><p><code>target</code>: the target evaluating metric computed by the <code>eval</code> or built-in function to stop the sequential design.</p></li>
<li><p><code>reached</code>: indicates whether the <code>target</code> was reached at the end of the sequential design:</p><ul><li><p>a bool if <code>object</code> is an instance of the <code>gp</code> or <code>dgp</code> class.</p></li>
<li><p>a vector of bools if <code>object</code> is an instance of the <code>bundle</code> class, with its length determined as follows:</p><ul><li><p>equal to the number of emulators in the bundle when <code>eval = NULL</code>.</p></li>
<li><p>equal to the length of the output from <code>eval</code> when a custom <code>eval</code> function is provided.</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>a slot called <code>type</code> that gives the type of validation:</p><ul><li><p>either LOO ('loo') or OOS ('oos') if <code>eval = NULL</code>. See <code><a href="validate.html">validate()</a></code> for more information about LOO and OOS.</p></li>
<li><p>'customized' if a customized R function is provided to <code>eval</code>.</p></li>
</ul></li>
<li><p>two slots called <code>x_test</code> and <code>y_test</code> that contain the data points for the OOS validation if the <code>type</code> slot is 'oos'.</p></li>
<li><p>If <code>y_cand = NULL</code> and <code>x_cand</code> is supplied, and there are <code>NA</code>s returned from the supplied <code>f</code> during the sequential design, a slot called <code>exclusion</code> is included
that records the located design positions that produced <code>NA</code>s via <code>f</code>. The sequential design will use this information to
avoid re-visiting the same locations in later runs of <code>design()</code>.</p></li>
</ul><p>See <em>Note</em> section below for further information.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See further examples and tutorials at <a href="https://mingdeyu.github.io/dgpsi-R/" class="external-link">https://mingdeyu.github.io/dgpsi-R/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>

<ul><li><p>Validation of an emulator is forced after the final step of a sequential design even if <code>N</code> is not a multiple of the second element in <code>freq</code>.</p></li>
<li><p>Any <code>loo</code> or <code>oos</code> slot that already exists in <code>object</code> will be cleaned, and a new slot called <code>loo</code> or <code>oos</code> will be created in the returned object
depending on whether <code>x_test</code> and <code>y_test</code> are provided. The new slot gives the validation information of the emulator constructed in the final step of
the sequential design. See <code><a href="validate.html">validate()</a></code> for more information about the slots <code>loo</code> and <code>oos</code>.</p></li>
<li><p>If <code>object</code> has previously been used by <code>design()</code> for sequential design, the information of the current wave of the sequential design will replace
those of old waves and be contained in the returned object, unless</p><ul><li><p>the validation type (LOO or OOS depending on whether <code>x_test</code> and <code>y_test</code> are supplied or not) of the current wave of the sequential design is the
same as the validation types (shown in the <code>type</code> of the <code>design</code> slot of <code>object</code>) in previous waves, and if the validation type is OOS,
<code>x_test</code> and <code>y_test</code> in the current wave must also be identical to those in the previous waves;</p></li>
<li><p>both the current and previous waves of the sequential design supply customized evaluation functions to <code>eval</code>. Users need to ensure the customized evaluation
functions are consistent among different waves. Otherwise, the trace plot of RMSEs produced by <code><a href="draw.html">draw()</a></code> will show values of different evaluation metrics in
different waves.</p></li>
</ul><p>For the above two cases, the information of the current wave of the sequential design will be added to the <code>design</code> slot of the returned object under the name <code>waveS</code>.</p></li>
<li><p>If <code>object</code> is an instance of the <code>gp</code> class and <code>eval = NULL</code>, the matrix in the <code>rmse</code> slot is single-columned. If <code>object</code> is an instance of
the <code>dgp</code> or <code>bundle</code> class and <code>eval = NULL</code>, the matrix in the <code>rmse</code> slot can have multiple columns that correspond to different output dimensions
or different emulators in the bundle.</p></li>
<li><p>If <code>object</code> is an instance of the <code>gp</code> class and <code>eval = NULL</code>, <code>target</code> needs to be a single value giving the RMSE threshold. If <code>object</code> is an instance
of the <code>dgp</code> or <code>bundle</code> class and <code>eval = NULL</code>, <code>target</code> can be a vector of values that gives the thresholds of evaluating metrics for different output dimensions or
different emulators. If a single value is provided, it will be used as the threshold for all output dimensions (if <code>object</code> is an instance of the <code>dgp</code>) or all emulators
(if <code>object</code> is an instance of the <code>bundle</code>). If a customized function is supplied to <code>eval</code> and <code>target</code> is given as a vector, the user needs to ensure that the length
of <code>target</code> is equal to that of the output from <code>eval</code>.</p></li>
<li><p>When defining <code>f</code>, it is important to ensure that:</p><ul><li><p>the column order of the first argument of <code>f</code> is consistent with the training input used for the emulator;</p></li>
<li><p>the column order of the output matrix of <code>f</code> is consistent with the order of emulator output dimensions (if <code>object</code> is an instance of the <code>dgp</code> class),
or the order of emulators placed in <code>object</code> (if <code>object</code> is an instance of the <code>bundle</code> class).</p></li>
</ul></li>
<li><p>The output matrix produced by <code>f</code> may include <code>NA</code>s. This is especially beneficial as it allows the sequential design process to continue without interruption,
even if errors or <code>NA</code> outputs are encountered from <code>f</code> at certain input locations identified by the sequential design. Users should ensure that any errors
within <code>f</code> are handled by appropriately returning <code>NA</code>s.</p></li>
<li><p>When defining <code>eval</code>, the output metric needs to be positive if <code><a href="draw.html">draw()</a></code> is used with <code>log = T</code>. And one needs to ensure that a lower metric value indicates
a better emulation performance if <code>target</code> is set.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load packages and the Python env</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bertcarnell/lhs" class="external-link">lhs</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mingdeyu/dgpsi-R" class="external-link">dgpsi</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># construct a 2D non-stationary function that takes a matrix as the input</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="fl">0.7</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span>,drop<span class="op">=</span><span class="cn">F</span><span class="op">]</span><span class="op">+</span><span class="fl">0.3</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">0.7</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span>,drop<span class="op">=</span><span class="cn">F</span><span class="op">]</span><span class="op">+</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate the initial design</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate the validation data</span></span></span>
<span class="r-in"><span><span class="va">validate_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">validate_y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">validate_x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># training a 2-layered DGP emulator with the initial design</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="dgp.html">dgp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify the ranges of the input dimensions</span></span></span>
<span class="r-in"><span><span class="va">lim_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lim_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">lim_1</span>, <span class="va">lim_2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1st wave of the sequential design with 10 steps</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">design</span><span class="op">(</span><span class="va">m</span>, N<span class="op">=</span><span class="fl">10</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2nd wave of the sequential design with 10 steps</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">design</span><span class="op">(</span><span class="va">m</span>, N<span class="op">=</span><span class="fl">10</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3rd wave of the sequential design with 10 steps</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">design</span><span class="op">(</span><span class="va">m</span>, N<span class="op">=</span><span class="fl">10</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># draw the design created by the sequential design</span></span></span>
<span class="r-in"><span><span class="fu"><a href="draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>,<span class="st">'design'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># inspect the trace of RMSEs during the sequential design</span></span></span>
<span class="r-in"><span><span class="fu"><a href="draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>,<span class="st">'rmse'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reduce the number of imputations for faster OOS</span></span></span>
<span class="r-in"><span><span class="va">m_faster</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_imp.html">set_imp</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the OOS validation with the faster DGP emulator</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">m_faster</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://mingdeyu.github.io" class="external-link">Deyu Ming</a>, <a href="https://experts.exeter.ac.uk/23142-daniel-williamson" class="external-link">Daniel Williamson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

