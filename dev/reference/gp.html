<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Gaussian process emulator construction — gp • dgpsi</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gaussian process emulator construction — gp"><meta name="description" content="This function builds and trains a GP emulator."><meta property="og:description" content="This function builds and trains a GP emulator."><meta property="og:image" content="http://mingdeyu.github.io/dgpsi-R/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dgpsi</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.4.0-9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dgpsi.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/motorcycle.html">DGP Emulation with the Heteroskedastic Gaussian Likelihood</a></li>
    <li><a class="dropdown-item" href="../articles/linked_DGP.html">Linked (D)GP Emulation</a></li>
    <li><a class="dropdown-item" href="../articles/seq_design.html">Sequential Design I</a></li>
    <li><a class="dropdown-item" href="../articles/seq_design_2.html">Sequential Design II</a></li>
    <li><a class="dropdown-item" href="../articles/large_scale_emulation.html">Large-scale Emulation with the Vecchia Approximation
    </a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">DGP Classification using dgpsi
    </a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mingdeyu/dgpsi-R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Gaussian process emulator construction</h1>
      <small class="dont-index">Source: <a href="https://github.com/mingdeyu/dgpsi-R/blob/master/R/gp.R" class="external-link"><code>R/gp.R</code></a></small>
      <div class="d-none name"><code>gp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function builds and trains a GP emulator.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gp</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"sexp"</span>,</span>
<span>  lengthscale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  bounds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"ref"</span>,</span>
<span>  nugget_est <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nugget <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">nugget_est</span>, <span class="fl">0.01</span>, <span class="fl">1e-08</span><span class="op">)</span>,</span>
<span>  scale_est <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  training <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verb <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  vecchia <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  ord <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  internal_input_idx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  linked_idx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a matrix where each row is an input data point and each column is an input dimension.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a matrix with only one column and each row being an output data point.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>kernel function to be used. Either <code>"sexp"</code> for squared exponential kernel or
<code>"matern2.5"</code> for Matérn-2.5 kernel. Defaults to <code>"sexp"</code>.</p></dd>


<dt id="arg-lengthscale">lengthscale<a class="anchor" aria-label="anchor" href="#arg-lengthscale"></a></dt>
<dd><p>initial values of lengthscales in the kernel function. It can be a single numeric value or a vector of length <code>ncol(X)</code>:</p><ul><li><p>if it is a single numeric value, it is assumed that kernel functions across input dimensions share the same lengthscale;</p></li>
<li><p>if it is a vector, it is assumed that kernel functions across input dimensions have different lengthscales.</p></li>
</ul><p>Defaults to a vector of <code>0.1</code>.</p></dd>


<dt id="arg-bounds">bounds<a class="anchor" aria-label="anchor" href="#arg-bounds"></a></dt>
<dd><p>the lower and upper bounds of lengthscales in the kernel function. It is a vector of length two where the first element is
the lower bound and the second element is the upper bound. The bounds will be applied to all lengthscales in the kernel function. Defaults
to <code>NULL</code> where no bounds are specified for the lengthscales.</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>prior to be used for Maximum a Posterior for lengthscales and nugget of the GP: gamma prior (<code>"ga"</code>), inverse gamma prior (<code>"inv_ga"</code>),
or jointly robust prior (<code>"ref"</code>). Defaults to <code>"ref"</code>. See the reference below for the jointly
robust prior.</p></dd>


<dt id="arg-nugget-est">nugget_est<a class="anchor" aria-label="anchor" href="#arg-nugget-est"></a></dt>
<dd><p>a bool indicating if the nugget term is to be estimated:</p><ol><li><p><code>FALSE</code>: the nugget term is fixed to <code>nugget</code>.</p></li>
<li><p><code>TRUE</code>: the nugget term will be estimated.</p></li>
</ol><p>Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-nugget">nugget<a class="anchor" aria-label="anchor" href="#arg-nugget"></a></dt>
<dd><p>the initial nugget value. If <code>nugget_est = FALSE</code>, the assigned value is fixed during the training.
Set <code>nugget</code> to a small value (e.g., <code>1e-8</code>) and the corresponding bool in <code>nugget_est</code> to <code>FALSE</code> for deterministic computer models where the emulator
should interpolate the training data points. Set <code>nugget</code> to a larger value and the corresponding bool in <code>nugget_est</code> to <code>TRUE</code> for stochastic
emulation where the computer model outputs are assumed to follow a homogeneous Gaussian distribution. Defaults to <code>1e-8</code> if <code>nugget_est = FALSE</code> and
<code>0.01</code> if <code>nugget_est = TRUE</code>.</p></dd>


<dt id="arg-scale-est">scale_est<a class="anchor" aria-label="anchor" href="#arg-scale-est"></a></dt>
<dd><p>a bool indicating if the variance is to be estimated:</p><ol><li><p><code>FALSE</code>: the variance is fixed to <code>scale</code>.</p></li>
<li><p><code>TRUE</code>: the variance term will be estimated.</p></li>
</ol><p>Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>the initial variance value. If <code>scale_est = FALSE</code>, the assigned value is fixed during the training.
Defaults to <code>1</code>.</p></dd>


<dt id="arg-training">training<a class="anchor" aria-label="anchor" href="#arg-training"></a></dt>
<dd><p>a bool indicating if the initialized GP emulator will be trained.
When set to <code>FALSE</code>, <code>gp()</code> returns an untrained GP emulator, to which one can apply <code><a href="summary.html">summary()</a></code> to inspect its specification or apply <code><a href="predict.html">predict()</a></code> to check its emulation performance before the training. Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-verb">verb<a class="anchor" aria-label="anchor" href="#arg-verb"></a></dt>
<dd><p>a bool indicating if the trace information on GP emulator construction and training will be printed during function execution.
Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-vecchia">vecchia<a class="anchor" aria-label="anchor" href="#arg-vecchia"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#new" class="external-link"><img src="figures/lifecycle-new.svg" alt="[New]"></a> a bool indicating whether to use Vecchia approximation for large-scale GP emulator construction and prediction. Defaults to <code>FALSE</code>.
The Vecchia approximation implemented for the GP emulation largely follows Katzfuss et al. (2022). See reference below.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#new" class="external-link"><img src="figures/lifecycle-new.svg" alt="[New]"></a> the size of the conditioning set for the Vecchia approximation in the GP emulator training. Defaults to <code>25</code>.</p></dd>


<dt id="arg-ord">ord<a class="anchor" aria-label="anchor" href="#arg-ord"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#new" class="external-link"><img src="figures/lifecycle-new.svg" alt="[New]"></a> an R function that returns the ordering of the input to the GP emulator for the Vecchia approximation. The function must satisfy the following basic rules:</p><ul><li><p>the first argument represents the input scaled by the lengthscales.</p></li>
<li><p>the output of the function is a vector of indices that gives the ordering of the input to the GP emulator.</p></li>
</ul><p>If <code>ord = NULL</code>, the default random ordering is used. Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-internal-input-idx">internal_input_idx<a class="anchor" aria-label="anchor" href="#arg-internal-input-idx"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> The column indices of <code>X</code> that are generated by the linked emulators in the preceding layers.
Set <code>internal_input_idx = NULL</code> if the GP emulator is in the first layer of a system or all columns in <code>X</code> are
generated by the linked emulators in the preceding layers. Defaults to <code>NULL</code>.</p>
<p><strong>The argument will be removed in the next release. To set up connections of emulators for linked emulations, please use the updated <code><a href="lgp.html">lgp()</a></code> function instead.</strong></p></dd>


<dt id="arg-linked-idx">linked_idx<a class="anchor" aria-label="anchor" href="#arg-linked-idx"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Either a vector or a list of vectors:</p><ul><li><p>If <code>linked_idx</code> is a vector, it gives indices of columns in the pooled output matrix (formed by column-combined outputs of all
emulators in the feeding layer) that feed into the GP emulator. The length of the vector shall equal to the length of <code>internal_input_idx</code> when <code>internal_input_idx</code>
is not <code>NULL</code>. If the GP emulator is in the first layer of a linked emulator system, the vector gives the column indices of the global
input (formed by column-combining all input matrices of emulators in the first layer) that the GP emulator will use. If the GP emulator is to be used in both the first
and subsequent layers, one should initially set <code>linked_idx</code> to the appropriate values for the situation where the emulator is not in the first layer. Then, use the
function <code><a href="set_linked_idx.html">set_linked_idx()</a></code> to reset the linking information when the emulator is in the first layer.</p></li>
<li><p>When the GP emulator is not in the first layer of a linked emulator system, <code>linked_idx</code> can be a list that gives the information on connections
between the GP emulator and emulators in all preceding layers. The length of the list should equal to the number of layers before
the GP emulator. Each element of the list is a vector that gives indices of columns in the pooled output matrix (formed by column-combined outputs
of all emulators) in the corresponding layer that feed into the GP emulator. If the GP emulator has no connections to any emulator in a certain layer,
set <code>NULL</code> in the corresponding position of the list. The order of input dimensions in <code>X[,internal_input_idx]</code> should be consistent with <code>linked_idx</code>.
For example, a GP emulator in the second layer that is fed by the output dimension 1 and 3 of emulators in layer 1 should have <code>linked_idx = list( c(1,3) )</code>.
In addition, the first and second columns of <code>X[,internal_input_idx]</code> should correspond to the output dimensions 1 and 3 from layer 1.</p></li>
</ul><p>Set <code>linked_idx = NULL</code> if the GP emulator will not be used for linked emulations. However, if this is no longer the case, one can use <code><a href="set_linked_idx.html">set_linked_idx()</a></code>
to add linking information to the GP emulator. Defaults to <code>NULL</code>.</p>
<p><strong>The argument will be removed in the next release. To set up connections of emulators for linked emulations, please use the updated <code><a href="lgp.html">lgp()</a></code> function instead.</strong></p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>an ID to be assigned to the GP emulator. If an ID is not provided (i.e., <code>id = NULL</code>), a UUID (Universally Unique Identifier) will be automatically generated
and assigned to the emulator. Default to <code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An S3 class named <code>gp</code> that contains five slots:</p><ul><li><p><code>id</code>: A number or character string assigned through the <code>id</code> argument.</p></li>
<li><p><code>data</code>: a list that contains two elements: <code>X</code> and <code>Y</code> which are the training input and output data respectively.</p></li>
<li><p><code>specs</code>: a list that contains seven elements:</p><ol><li><p><code>kernel</code>: the type of the kernel function used. Either <code>"sexp"</code> for squared exponential kernel or <code>"matern2.5"</code> for Matérn-2.5 kernel.</p></li>
<li><p><code>lengthscales</code>: a vector of lengthscales in the kernel function.</p></li>
<li><p><code>scale</code>: the variance value in the kernel function.</p></li>
<li><p><code>nugget</code>: the nugget value in the kernel function.</p></li>
<li><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> <code>internal_dims</code>: the column indices of <code>X</code> that correspond to the linked emulators in the preceding layers of a linked system.
<strong>The slot will be removed in the next release</strong>.</p></li>
<li><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> <code>external_dims</code>: the column indices of <code>X</code> that correspond to global inputs to the linked system of emulators.
It is shown as <code>FALSE</code> if <code>internal_input_idx = NULL</code>. <strong>The slot will be removed in the next release</strong>.</p></li>
<li><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> <code>linked_idx</code>: the value passed to argument <code>linked_idx</code>. It is shown as <code>FALSE</code> if the argument <code>linked_idx</code> is <code>NULL</code>.
<strong>The slot will be removed in the next release</strong>.</p></li>
<li><p><a href="https://lifecycle.r-lib.org/articles/stages.html#new" class="external-link"><img src="figures/lifecycle-new.svg" alt="[New]"></a> <code>vecchia</code>: whether the Vecchia approximation is used for the GP emulator training.</p></li>
<li><p><a href="https://lifecycle.r-lib.org/articles/stages.html#new" class="external-link"><img src="figures/lifecycle-new.svg" alt="[New]"></a> <code>M</code>: the size of the conditioning set for the Vecchia approximation in the GP emulator training.</p></li>
</ol></li>
<li><p><code>constructor_obj</code>: a 'python' object that stores the information of the constructed GP emulator.</p></li>
<li><p><code>container_obj</code>: a 'python' object that stores the information for the linked emulation.</p></li>
<li><p><code>emulator_obj</code>: a 'python' object that stores the information for the predictions from the GP emulator.</p></li>
</ul><p>The returned <code>gp</code> object can be used by</p><ul><li><p><code><a href="predict.html">predict()</a></code> for GP predictions.</p></li>
<li><p><code><a href="validate.html">validate()</a></code> for LOO and OOS validations.</p></li>
<li><p><code><a href="plot.html">plot()</a></code> for validation plots.</p></li>
<li><p><code><a href="lgp.html">lgp()</a></code> for linked (D)GP emulator constructions.</p></li>
<li><p><code><a href="summary.html">summary()</a></code> to summarize the trained GP emulator.</p></li>
<li><p><code><a href="write.html">write()</a></code> to save the GP emulator to a <code>.pkl</code> file.</p></li>
<li><p><code><a href="design.html">design()</a></code> for sequential designs.</p></li>
<li><p><code><a href="update.html">update()</a></code> to update the GP emulator with new inputs and outputs.</p></li>
<li><p><code><a href="alm.html">alm()</a></code>, <code><a href="mice.html">mice()</a></code>, and <code><a href="vigf.html">vigf()</a></code> to locate next design points.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See further examples and tutorials at <a href="https://mingdeyu.github.io/dgpsi-R/dev/" class="external-link">https://mingdeyu.github.io/dgpsi-R/dev/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Any R vector detected in <code>X</code> and <code>Y</code> will be treated as a column vector and automatically converted into a single-column
R matrix. Thus, if <code>X</code> is a single data point with multiple dimensions, it must be given as a matrix.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Gu, M. (2019). Jointly robust prior for Gaussian stochastic process in emulation, calibration and variable selection. <em>Bayesian Analysis</em>, <strong>14(3)</strong>, 857-885.</p></li>
<li><p>Katzfuss, M., Guinness, J., &amp; Lawrence, E. (2022). Scaled Vecchia approximation for fast computer-model emulation. <em>SIAM/ASA Journal on Uncertainty Quantification</em>, <strong>10(2)</strong>, 537-554.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># load the package and the Python env</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mingdeyu/dgpsi-R" class="external-link">dgpsi</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># construct a step function</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate training data</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># training</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">gp</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summarizing</span></span></span>
<span class="r-in"><span><span class="fu"><a href="summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># LOO cross validation</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="validate.html">validate</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># prediction</span></span></span>
<span class="r-in"><span><span class="va">test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict.html">predict</a></span><span class="op">(</span><span class="va">m</span>, x <span class="op">=</span> <span class="va">test_x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># OOS validation</span></span></span>
<span class="r-in"><span><span class="va">validate_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">test_x</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">validate_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">validate_x</span>, <span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">validate_x</span>, <span class="va">validate_y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># write and read the constructed emulator</span></span></span>
<span class="r-in"><span><span class="fu"><a href="write.html">write</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">'step_gp'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="read.html">read</a></span><span class="op">(</span><span class="st">'step_gp'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://mingdeyu.github.io" class="external-link">Deyu Ming</a>, <a href="https://experts.exeter.ac.uk/23142-daniel-williamson" class="external-link">Daniel Williamson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

