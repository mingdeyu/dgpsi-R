<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function implements single-core or multi-core predictions (with or without multi-threading)
from GP, DGP, or linked (D)GP emulators."><title>Predictions from GP, DGP, or linked (D)GP emulators — predict • dgpsi</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predictions from GP, DGP, or linked (D)GP emulators — predict"><meta property="og:description" content="This function implements single-core or multi-core predictions (with or without multi-threading)
from GP, DGP, or linked (D)GP emulators."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dgpsi</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.1.5-9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/dgpsi.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/motorcycle.html">DGP Emulation with the Heteroskedastic Gaussian Likelihood
</a>
    <a class="dropdown-item" href="../articles/linked_DGP.html">Linked (D)GP Emulation</a>
    <a class="dropdown-item" href="../articles/seq_design.html">Sequential Design I</a>
    <a class="dropdown-item" href="../articles/seq_design_2.html">Sequential Design II</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mingdeyu/dgpsi-R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Predictions from GP, DGP, or linked (D)GP emulators</h1>
      <small class="dont-index">Source: <a href="https://github.com/mingdeyu/dgpsi-R/blob/HEAD/R/prediction.R" class="external-link"><code>R/prediction.R</code></a></small>
      <div class="d-none name"><code>predict.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements single-core or multi-core predictions (with or without multi-threading)
from GP, DGP, or linked (D)GP emulators.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for dgp</span></span>
<span><span class="fu">predict</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mean_var"</span>,</span>
<span>  full_layer <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  chunks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  threading <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for lgp</span></span>
<span><span class="fu">predict</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mean_var"</span>,</span>
<span>  full_layer <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  chunks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  threading <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for gp</span></span>
<span><span class="fu">predict</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mean_var"</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  chunks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>an instance of the <code>gp</code>, <code>dgp</code>, or <code>lgp</code> class.</p></dd>


<dt>x</dt>
<dd><p>the testing input data:</p><ul><li><p>if <code>object</code> is an instance of the <code>gp</code> or <code>dgp</code> class, <code>x</code> is a matrix where each row is an input testing data point and each column is an input dimension.</p></li>
<li><p>if <code>object</code> is an instance of the <code>lgp</code> class, <code>x</code> can be a matrix or a list:</p><ul><li><p>if <code>x</code> is a matrix, it is the global testing input data that feed into the emulators in the first layer of a system.
The rows of <code>x</code> represent different input data points and the columns represent input dimensions across all emulators in
the first layer of the system. In this case, it is assumed that the only global input to the system is the input to the
emulators in the first layer and there is no global input to emulators in other layers.</p></li>
<li><p>if <code>x</code> is a list, it should have <em>L</em> (the number of layers in an emulator system) elements. The first element
is a matrix that represents the global testing input data that feed into the emulators in the first layer of the system. The
remaining <em>L-1</em> elements are <em>L-1</em> sub-lists, each of which contains a number (the same number of emulators in
the corresponding layer) of matrices (rows being testing input data points and columns being input dimensions) that represent the
global testing input data to the emulators in the corresponding layer. The matrices must be placed in the sub-lists based on how
their corresponding emulators are placed in <code>struc</code> argument of <code><a href="lgp.html">lgp()</a></code>. If there is no global input data to a certain emulator,
set <code>NULL</code> in the corresponding sub-list of <code>x</code>.</p></li>
</ul></li>
</ul></dd>


<dt>method</dt>
<dd><p>the prediction approach: mean-variance (<code>"mean_var"</code>) or sampling (<code>"sampling"</code>) approach. Defaults to <code>"mean_var"</code>.</p></dd>


<dt>full_layer</dt>
<dd><p>a bool indicating whether to output the predictions of all layers. Defaults to <code>FALSE</code>. Only used when <code>object</code> is a DGP and linked (D)GP emulator.</p></dd>


<dt>sample_size</dt>
<dd><p>the number of samples to draw for each given imputation if <code>method = "sampling"</code>. Defaults to <code>50</code>.</p></dd>


<dt>cores</dt>
<dd><p>the number of cores/workers to be used. If set to <code>NULL</code>,
the number of cores is set to <code>(max physical cores available - 1)</code>. Defaults to <code>1</code>.</p></dd>


<dt>chunks</dt>
<dd><p>the number of chunks that the testing input matrix <code>x</code> will be divided into for multi-cores to work on.
Only used when <code>cores</code> is not <code>1</code>. If not specified (i.e., <code>chunks = NULL</code>), the number of chunks is set to the value of <code>cores</code>.
Defaults to <code>NULL</code>.</p></dd>


<dt>threading</dt>
<dd><p>a bool indicating whether to use the multi-threading to accelerate the predictions of DGP or linked (D)GP emulators. Turn this option on
when you use the Matérn-2.5 kernel and have a moderately large number of training data points as in such a case you could gain faster predictions. Defaults to <code>FALSE</code>.</p></dd>


<dt>...</dt>
<dd><p>N/A.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<ul><li><p>If <code>object</code> is an instance of the <code>gp</code> class:</p><ol><li><p>if <code>method = "mean_var"</code>: an updated <code>object</code> is returned with an additional slot called <code>results</code> that contains two matrices named <code>mean</code>
for the predictive means and <code>var</code> for the predictive variances. Each matrix has only one column with its rows
corresponding to testing positions (i.e., rows of <code>x</code>).</p></li>
<li><p>if <code>method = "sampling"</code>: an updated <code>object</code> is returned with an additional slot called <code>results</code> that contains a matrix whose rows correspond
to testing positions and columns correspond to <code>sample_size</code> number of samples drawn from the predictive distribution of GP.</p></li>
</ol></li>
<li><p>If <code>object</code> is an instance of the <code>dgp</code> class:</p><ol><li><p>if <code>method = "mean_var"</code> and  <code>full_layer = FALSE</code>: an updated <code>object</code> is returned with an additional slot called <code>results</code> that contains two
matrices named <code>mean</code> for the predictive means and <code>var</code> for the predictive variances respectively. Each matrix has its rows corresponding to testing
positions and columns corresponding to DGP global output dimensions (i.e., the number of GP/likelihood nodes in the final layer).</p></li>
<li><p>if <code>method = "mean_var"</code> and  <code>full_layer = TRUE</code>: an updated <code>object</code> is returned with an additional slot called <code>results</code> that contains two
sub-lists named <code>mean</code> for the predictive means and <code>var</code> for the predictive variances respectively. Each sub-list contains <em>L</em> (i.e., the number of layers)
matrices named <code>layer1, layer2,..., layerL</code>. Each matrix has its rows corresponding to testing positions and columns corresponding to
output dimensions (i.e., the number of GP/likelihood nodes from the associated layer).</p></li>
<li><p>if <code>method = "sampling"</code> and  <code>full_layer = FALSE</code>: an updated <code>object</code> is returned with an additional slot called <code>results</code> that contains <em>D</em> (i.e., the number
of GP/likelihood nodes in the final layer) matrices named <code>output1, output2,..., outputD</code>. Each matrix has its rows corresponding to testing positions and
columns corresponding to samples of size: <code>B * sample_size</code>, where <code>B</code> is the number of imputations specified in <code><a href="dgp.html">dgp()</a></code>.</p></li>
<li><p>if <code>method = "sampling"</code> and  <code>full_layer = TRUE</code>: an updated <code>object</code> is returned with an additional slot called <code>results</code> that contains <em>L</em> (i.e., the number
of layers) sub-lists named <code>layer1, layer2,..., layerL</code>. Each sub-list represents samples drawn from the GP/likelihood nodes in the corresponding layer,
and contains <em>D</em> (i.e., the number of GP/likelihood nodes in the corresponding layer) matrices named <code>output1, output2,..., outputD</code>. Each matrix gives samples
of the output from one of <em>D</em> GP/likelihood nodes, and has its rows corresponding to testing positions and columns corresponding to samples
of size: <code>B * sample_size</code>, where <code>B</code> is the number of imputations specified in <code><a href="dgp.html">dgp()</a></code>.</p></li>
</ol></li>
<li><p>If <code>object</code> is an instance of the <code>lgp</code> class:</p><ol><li><p>if <code>method = "mean_var"</code> and  <code>full_layer = FALSE</code>: an updated <code>object</code> is returned with an additional slot called <code>results</code> that
contains two sub-lists named <code>mean</code> for the predictive means and <code>var</code> for the predictive variances respectively. Each sub-list
contains <em>M</em> number (same number of emulators in the final layer of the system) of matrices named <code>emulator1, emulator2,..., emulatorM</code>.
Each matrix has its rows corresponding to global testing positions and columns corresponding to output dimensions of the associated emulator
in the final layer.</p></li>
<li><p>if <code>method = "mean_var"</code> and  <code>full_layer = TRUE</code>: an updated <code>object</code> is returned with an additional slot called <code>results</code> that contains
two sub-lists named <code>mean</code> for the predictive means and <code>var</code> for the predictive variances respectively. Each sub-list contains <em>L</em>
(i.e., the number of layers in the emulated system) components named <code>layer1, layer2,..., layerL</code>. Each component represents a layer
and contains <em>M</em> number (same number of emulators in the corresponding layer of the system) of matrices named <code>emulator1, emulator2,..., emulatorM</code>.
Each matrix has its rows corresponding to global testing positions and columns corresponding to output dimensions of the associated
GP/DGP emulator in the corresponding layer.</p></li>
<li><p>if <code>method = "sampling"</code> and  <code>full_layer = FALSE</code>: an updated <code>object</code> is returned with an additional slot called <code>results</code> that contains
<em>M</em> number (same number of emulators in the final layer of the system) of sub-lists named <code>emulator1, emulator2,..., emulatorM</code>. Each
sub-list corresponds to an emulator in the final layer, and contains <em>D</em> matrices, named <code>output1, output2,..., outputD</code>, that correspond to the output
dimensions of the GP/DGP emulator. Each matrix has its rows corresponding to testing positions and columns corresponding to samples
of size: <code>B * sample_size</code>, where <code>B</code> is the number of imputations specified in <code><a href="lgp.html">lgp()</a></code>.</p></li>
<li><p>if <code>method = "sampling"</code> and  <code>full_layer = TRUE</code>: an updated <code>object</code> is returned with an additional slot called <code>results</code> that contains
<em>L</em> (i.e., the number of layers of the emulated system) sub-lists named <code>layer1, layer2,..., layerL</code>. Each sub-list represents a layer
and contains <em>M</em> number (same number of emulators in the corresponding layer of the system) of components named <code>emulator1, emulator2,..., emulatorM</code>.
Each component corresponds to an emulator in the associated layer, and contains <em>D</em> matrices, named <code>output1, output2,..., outputD</code>, that correspond to
the output dimensions of the GP/DGP emulator. Each matrix has its rows corresponding to testing positions and columns corresponding to
samples of size: <code>B * sample_size</code>, where <code>B</code> is the number of imputations specified in <code><a href="lgp.html">lgp()</a></code>.</p></li>
</ol></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See further examples and tutorials at <a href="https://mingdeyu.github.io/dgpsi-R/" class="external-link">https://mingdeyu.github.io/dgpsi-R/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Any R vector detected in <code>x</code> will be treated as a column vector and automatically converted into a single-column R matrix.
Thus, if <code>x</code> is a single testing data point with multiple dimensions, it must be given as a matrix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See gp(), dgp(), or lgp() for an example.</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Deyu Ming, Daniel Williamson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

