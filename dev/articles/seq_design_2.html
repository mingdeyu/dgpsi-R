<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Sequential design for a bundle of DGP emulators with the stopping rule.
">
<title>Sequential Design II â€¢ dgpsi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sequential Design II">
<meta property="og:description" content="Sequential design for a bundle of DGP emulators with the stopping rule.
">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dgpsi</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.1.6-9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/dgpsi.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/motorcycle.html">DGP Emulation with the Heteroskedastic Gaussian Likelihood
</a>
    <a class="dropdown-item" href="../articles/linked_DGP.html">Linked (D)GP Emulation</a>
    <a class="dropdown-item" href="../articles/seq_design.html">Sequential Design I</a>
    <a class="dropdown-item" href="../articles/seq_design_2.html">Sequential Design II</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mingdeyu/dgpsi-R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Sequential Design II</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mingdeyu/dgpsi-R/blob/HEAD/vignettes/seq_design_2.Rmd" class="external-link"><code>vignettes/seq_design_2.Rmd</code></a></small>
      <div class="d-none name"><code>seq_design_2.Rmd</code></div>
    </div>

    
    
<p>This vignette shows how to use the package to sequentially refine a
bundle of DGP emulators, each of which emulates an output of a
simulator.</p>
<div class="section level2">
<h2 id="load-the-packages">Load the packages<a class="anchor" aria-label="anchor" href="#load-the-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bertcarnell/lhs" class="external-link">lhs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mingdeyu/dgpsi-R" class="external-link">dgpsi</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/init_py.html">init_py</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Connecting to Python ... done</span></span>
<span><span class="co">## Importing required Python modules ... done</span></span>
<span><span class="co">## The Python environment for 'dgpsi' is successfully loaded.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="construct-a-synthetic-simulator">Construct a synthetic simulator<a class="anchor" aria-label="anchor" href="#construct-a-synthetic-simulator"></a>
</h2>
<p>We construct a synthetic simulator that has a one-dimensional input
between <code>[0, 1]</code> and a three-dimensional output.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">y1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">30</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">x</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="fl">0.4</span><span class="op">)</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">20</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">x</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">y2</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">x</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">2</span><span class="op">/</span><span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">x</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span></span>
<span>  <span class="va">y3</span> <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">7.5</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span>, <span class="va">y3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note that the function is defined in such a way that both its input
<code>x</code> and output are matrices. The following figure shows the
true functional forms of the three outputs of the simulator over
<code>[0, 1]</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dense_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">dense_y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">dense_x</span><span class="op">)</span></span>
<span><span class="va">output1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'x'</span> <span class="op">=</span> <span class="va">dense_x</span>, <span class="st">'y'</span> <span class="op">=</span> <span class="va">dense_y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">output2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'x'</span> <span class="op">=</span> <span class="va">dense_x</span>, <span class="st">'y'</span> <span class="op">=</span> <span class="va">dense_y</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">output3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'x'</span> <span class="op">=</span> <span class="va">dense_x</span>, <span class="st">'y'</span> <span class="op">=</span> <span class="va">dense_y</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">output1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'dodgerblue2'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'Output 1'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">output2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'#E31A1C'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'Output 2'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">output3</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'green4'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'Output 3'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Synthetic Simulator'</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq2_fct.png"></p>
<p>We now specify a seed with <code><a href="../reference/set_seed.html">set_seed()</a></code> from the package
for reproducibility</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_seed.html">set_seed</a></span><span class="op">(</span><span class="fl">99</span><span class="op">)</span></span></code></pre></div>
<p>and generate an initial design with 5 design points using the maximin
Latin hypercube sampler:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code></pre></div>
<p>We generate a validation dataset to track and stop the sequential
design:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">validate_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">validate_y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">validate_x</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="construct-a-bundle-of-dgp-emulators">Construct a bundle of DGP emulators<a class="anchor" aria-label="anchor" href="#construct-a-bundle-of-dgp-emulators"></a>
</h2>
<p>Before we start the sequential design, we build three DGP emulators
that emulate the three outputs of the simulator <code>f</code>
independently:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, connect <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Auto-generating a 2-layered DGP structure ... done</span></span>
<span><span class="co">## Initializing the DGP emulator ... done</span></span>
<span><span class="co">## Training the DGP emulator: </span></span>
<span><span class="co">## Iteration 500: Layer 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 500/500 [00:02&lt;00:00, 224.64it/s]</span></span>
<span><span class="co">## Imputing ... done</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, connect <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Auto-generating a 2-layered DGP structure ... done</span></span>
<span><span class="co">## Initializing the DGP emulator ... done</span></span>
<span><span class="co">## Training the DGP emulator: </span></span>
<span><span class="co">## Iteration 500: Layer 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 500/500 [00:02&lt;00:00, 248.10it/s]</span></span>
<span><span class="co">## Imputing ... done</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Auto-generating a 2-layered DGP structure ... done</span></span>
<span><span class="co">## Initializing the DGP emulator ... done</span></span>
<span><span class="co">## Training the DGP emulator: </span></span>
<span><span class="co">## Iteration 500: Layer 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 500/500 [00:01&lt;00:00, 421.89it/s]</span></span>
<span><span class="co">## Imputing ... done</span></span></code></pre>
<p>Note that we have the global connection turned off for the first two
DGP emulators because we found that this yields better emulation
performances. We then build a bundle of the three DGP emulators using
<code><a href="../reference/pack.html">pack()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pack.html">pack</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sequential-designs-of-the-bundle-emulator">Sequential designs of the bundle emulator<a class="anchor" aria-label="anchor" href="#sequential-designs-of-the-bundle-emulator"></a>
</h2>
<p>To start with the sequential design, we specify the limit of the
input:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>and set a target RMSE to stop the sequential design:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span></code></pre></div>
<p>Here we choose <code>0.01</code> because it is equivalent to
<code>1%</code> normalized error given that the ranges of both outputs
are <code>[0,1]</code>. We can of course set different targets for
different outputs, e.g., by setting
<code>target &lt;- c(0.005, 0.02, 0.01)</code>.</p>
<p>We start the first-wave of the sequential design with 10 steps:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1st wave of the sequential design with 10 steps</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/design.html">design</a></span><span class="op">(</span><span class="va">m</span>, N <span class="op">=</span> <span class="fl">10</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing ... done</span></span>
<span><span class="co">##  * RMSE: 0.521768 0.162249 0.010418</span></span>
<span><span class="co">## Iteration 1:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point (Emulator1): 0.003421</span></span>
<span><span class="co">##  * Next design point (Emulator2): 0.003421</span></span>
<span><span class="co">##  * Next design point (Emulator3): 0.007783</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.476133 0.169318 0.005171</span></span>
<span><span class="co">## Iteration 2:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point (Emulator1): 0.362879</span></span>
<span><span class="co">##  * Next design point (Emulator2): 0.995688</span></span>
<span><span class="co">##  * Next design point (Emulator3): None (target reached)</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.472015 0.201739 0.005171</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  ...</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Iteration 10:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point (Emulator1): 0.090828</span></span>
<span><span class="co">##  * Next design point (Emulator2): 0.485472</span></span>
<span><span class="co">##  * Next design point (Emulator3): None (target reached)</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.091950 0.017712 0.005171</span></span>
<span><span class="co">## Targets are not reached for all emulators at the end of the sequential design.</span></span></code></pre>
<p>It can be seen that at the second step, the DGP emulator for the
third output has already reached the target, so for the rest of the
steps no further refinements (i.e., additions of design points to the
third DGP emulator) are performed. At the end of the first wave, the DGP
emulators for both the first and second outputs have not reached the
target yet. At this point, we can proceed to a second wave by repeating
the command above, but we show below an alternative way, in which we
define an aggregation function that aggregates criterion scores across
the three outputs such that the same design points are added to the
three emulators at each step (instead of different design points for
each emulator). We define the aggregation function <code>g</code> that
aggregate scores by calculating their weighted average:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">weight</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">weight</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">weight</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">weight</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Since the third emulator has already reached the target, we assign
zero weights to it and weights of 0.8 and 0.2 to the first and second
emulators respectively:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>We now pass both the aggregate function <code>g()</code> and its
<code>weight</code> argument to <code><a href="../reference/design.html">design()</a></code> for the second
wave of the sequential design with a further 15 steps:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2nd wave with 15 steps</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/design.html">design</a></span><span class="op">(</span><span class="va">m</span>, N <span class="op">=</span> <span class="fl">15</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, aggregate <span class="op">=</span> <span class="va">g</span>, target <span class="op">=</span> <span class="fl">0.01</span>, weight <span class="op">=</span> <span class="va">weight</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing ... done</span></span>
<span><span class="co">##  * RMSE: 0.091950 0.017712 0.005171</span></span>
<span><span class="co">## Iteration 1:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point (Emulator1): 0.403398</span></span>
<span><span class="co">##  * Next design point (Emulator2): 0.403398</span></span>
<span><span class="co">##  * Next design point (Emulator3): None (target reached)</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.125244 0.006897 0.005171</span></span>
<span><span class="co">## Iteration 2:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point (Emulator1): 0.028182</span></span>
<span><span class="co">##  * Next design point (Emulator2): None (target reached)</span></span>
<span><span class="co">##  * Next design point (Emulator3): None (target reached)</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.040983 0.006897 0.005171</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Iteration 9:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point (Emulator1): 0.012557</span></span>
<span><span class="co">##  * Next design point (Emulator2): None (target reached)</span></span>
<span><span class="co">##  * Next design point (Emulator3): None (target reached)</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.009377 0.006897 0.005171</span></span>
<span><span class="co">## Target reached! The sequential design stops at step 9.</span></span></code></pre>
<p>The first and the second emulators reached the target after iteration
9 and 1 of the second wave, respectively. The sequential designs of the
three emulators can be plotted with <code><a href="../reference/draw.html">draw()</a></code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">1</span>, <span class="st">'design'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">2</span>, <span class="st">'design'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">3</span>, <span class="st">'design'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq2_design.png"></p>
<p>The figure above shows that for the first emulator most of the design
points are added below 0.5 whilst for the second emulator most of the
design points concentrate around 0.5. For the third emulator, the
resulting design is space-filling. It can be seen that these design
point distributions are consistent with the functional complexities of
the three outputs.</p>
</div>
<div class="section level2">
<h2 id="comparison-to-dgp-emulators-with-space-filling-designs">Comparison to DGP emulators with space-filling designs<a class="anchor" aria-label="anchor" href="#comparison-to-dgp-emulators-with-space-filling-designs"></a>
</h2>
<p>We build three independent DGP emulators for the three outputs with
static space-filling Latin hypercube designs (LHD) of size 10, 20, and
30 respectively:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulators with a LHD of size 10</span></span>
<span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y1</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X1</span><span class="op">)</span></span>
<span><span class="va">m11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">Y1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, connect <span class="op">=</span> <span class="cn">F</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">Y1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, connect <span class="op">=</span> <span class="cn">F</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">Y1</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 20</span></span>
<span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X2</span><span class="op">)</span></span>
<span><span class="va">m21</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X2</span>, <span class="va">Y2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, connect <span class="op">=</span> <span class="cn">F</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m22</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X2</span>, <span class="va">Y2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, connect <span class="op">=</span> <span class="cn">F</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m23</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X2</span>, <span class="va">Y2</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 30</span></span>
<span><span class="va">X3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y3</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X3</span><span class="op">)</span></span>
<span><span class="va">m31</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X3</span>, <span class="va">Y3</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, connect <span class="op">=</span> <span class="cn">F</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m32</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X3</span>, <span class="va">Y3</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, connect <span class="op">=</span> <span class="cn">F</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m33</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X3</span>, <span class="va">Y3</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>We then extract their RMSEs</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># validations of the first DGP emulator</span></span>
<span><span class="va">m11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m11</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m21</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m21</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m31</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m31</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse_static_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'N'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, <span class="st">'rmse'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m11</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span>, <span class="va">m21</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span>, <span class="va">m31</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span><span class="op">)</span>, <span class="st">'LHD'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lhd-10'</span>, <span class="st">'lhd-20'</span>, <span class="st">'lhd-30'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># validations of the second DGP emulator</span></span>
<span><span class="va">m12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m12</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m22</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m22</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m32</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m32</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse_static_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'N'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, <span class="st">'rmse'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m12</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span>, <span class="va">m22</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span>, <span class="va">m32</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span><span class="op">)</span>, <span class="st">'LHD'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lhd-10'</span>, <span class="st">'lhd-20'</span>, <span class="st">'lhd-30'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># # validations of the third DGP emulator</span></span>
<span><span class="va">m13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m13</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m23</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m23</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">m33</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m33</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse_static_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'N'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, <span class="st">'rmse'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m13</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span>, <span class="va">m23</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span>, <span class="va">m33</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span><span class="op">)</span>, <span class="st">'LHD'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lhd-10'</span>, <span class="st">'lhd-20'</span>, <span class="st">'lhd-30'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>and add them to the sequential design validation plot (in log-scale)
for comparisons:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, emulator <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'rmse'</span>, log <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rmse_static_1</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>, y <span class="op">=</span> <span class="va">rmse</span>, group <span class="op">=</span> <span class="va">LHD</span>, shape <span class="op">=</span> <span class="va">LHD</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'#E69F00'</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, emulator <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">'rmse'</span>, log <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rmse_static_2</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>, y <span class="op">=</span> <span class="va">rmse</span>, group <span class="op">=</span> <span class="va">LHD</span>, shape <span class="op">=</span> <span class="va">LHD</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'#E69F00'</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, emulator <span class="op">=</span> <span class="fl">3</span>, type <span class="op">=</span> <span class="st">'rmse'</span>, log <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rmse_static_3</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>, y <span class="op">=</span> <span class="va">rmse</span>, group <span class="op">=</span> <span class="va">LHD</span>, shape <span class="op">=</span> <span class="va">LHD</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'#E69F00'</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq2_rmse.png"></p>
<p>It can be seen from the plot above that with the sequential design,
emulators in the bundle can achieve higher or similar accuracy with
smaller number of design points.</p>
<div class="section level3">
<h3 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h3>
<p>See <a href="https://mingdeyu.github.io/dgpsi-R/articles/seq_design.html" class="external-link"><code>Sequential Design I</code></a>
for the sequential design of a DGP emulator on a 2D simulator.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Deyu Ming, Daniel Williamson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
