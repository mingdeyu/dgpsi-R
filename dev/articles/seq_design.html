<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sequential Design I • dgpsi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sequential Design I">
<meta name="description" content="Sequential design and dynamic pruning for DGP emulation of a non-stationary simulator.
">
<meta property="og:description" content="Sequential design and dynamic pruning for DGP emulation of a non-stationary simulator.
">
<meta property="og:image" content="http://mingdeyu.github.io/dgpsi-R/logo.png">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dgpsi</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.6.0-9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/dgpsi.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/large_scale_emulation.html">Large-Scale DGP Emulation</a></li>
    <li><a class="dropdown-item" href="../articles/linked_DGP.html">Linked (D)GP Emulation</a></li>
    <li><a class="dropdown-item" href="../articles/motorcycle.html">Non-Gaussian Emulation</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">DGP Classification</a></li>
    <li><a class="dropdown-item" href="../articles/seq_design.html">Sequential Design I</a></li>
    <li><a class="dropdown-item" href="../articles/seq_design_2.html">Sequential Design II</a></li>
    <li><a class="dropdown-item" href="../articles/bayes_opt.html">Bayesian Optimization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mingdeyu/dgpsi-R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sequential Design I</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mingdeyu/dgpsi-R/blob/master/vignettes/seq_design.Rmd" class="external-link"><code>vignettes/seq_design.Rmd</code></a></small>
      <div class="d-none name"><code>seq_design.Rmd</code></div>
    </div>

    
    
<p>This vignette shows how to use <code>dgpsi</code> to sequentially
enrich a design for adaptive improvement and pruning of an emulator. We
choose a DGP for this example, but the methods work equally well on all
types of emulator.</p>
<div class="section level2">
<h2 id="load-the-packages">Load the packages<a class="anchor" aria-label="anchor" href="#load-the-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bertcarnell/lhs" class="external-link">lhs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mingdeyu/dgpsi-R" class="external-link">dgpsi</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="construct-a-synthetic-simulator">Construct a synthetic simulator<a class="anchor" aria-label="anchor" href="#construct-a-synthetic-simulator"></a>
</h2>
<p>We consider a non-stationary synthetic simulator which has a
2-dimensional input with the functional form <span class="citation">(Ba
and Joseph 2018)</span> defined by:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="fl">0.7</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span>,drop<span class="op">=</span><span class="cn">F</span><span class="op">]</span><span class="op">+</span><span class="fl">0.3</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">0.7</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span>,drop<span class="op">=</span><span class="cn">F</span><span class="op">]</span><span class="op">+</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="op">}</span></span></code></pre></div>
<p>Note that to provide the simulator for the sequential design below,
we have defined the above function such that its input <code>x</code>
and output are both matrices. The commands below generate the contour of
the function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">expand_grid</span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">dat</span>, f <span class="op">=</span> <span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, fill <span class="op">=</span> <span class="va">f</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"viridis"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq_fct.png" style="width:100.0%"></p>
<p>We can see from the figure above that the synthetic simulator
exhibits more fluctuations on the bottom left of its input space while
in the top-right part, the simulator shows little variation.</p>
<p>We now specify a seed with <code><a href="../reference/set_seed.html">set_seed()</a></code> for
reproducibility</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_seed.html">set_seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span></span></code></pre></div>
<p>and generate an initial design with 5 design points using the maximin
Latin hypercube sampler:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code></pre></div>
<p>To track the qualities of constructed emulators during sequential
design, we generate a validation dataset:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">validate_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">validate_y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">validate_x</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dgp-emulation-with-sequential-designs">DGP emulation with sequential designs<a class="anchor" aria-label="anchor" href="#dgp-emulation-with-sequential-designs"></a>
</h2>
<p>To start with the sequential design, we initialize a two-layered DGP
emulator (with 2 GP nodes in the first layer and 1 GP node in the second
layer) using the generated initial design:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Auto-generating a 2-layered DGP structure ... done</span></span>
<span><span class="co">## Initializing the DGP emulator ... done</span></span>
<span><span class="co">## Training the DGP emulator: </span></span>
<span><span class="co">## Iteration 500: Layer 2: 100%|██████████| 500/500 [00:01&lt;00:00, 353.90it/s]</span></span>
<span><span class="co">## Imputing ... done</span></span></code></pre>
<p>We then specify the boundaries of the input parameter space for
<code>f</code> so that the sequential design can restrict its search for
new points.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lim_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">lim_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">lim_1</span>, <span class="va">lim_2</span><span class="op">)</span></span></code></pre></div>
<p>The limits of the input parameters are defined as a matrix with each
row giving the lower and upper limits of an input parameter. After the
boundaries are specified, we are ready to conduct a sequential design
that adaptively improve the emulator, <code>m</code>, via
<code><a href="../reference/design.html">design()</a></code>. The function <code><a href="../reference/design.html">design()</a></code> provides a
simple and flexible implementation of sequential design for emulation.
In this vignette, we only demonstrate its basic usage and refer users to
<code><a href="../reference/design.html">?design</a></code> for more advanced specification, e.g., on
checkpoints to manually control the design progress and on schedules to
re-fit and validate emulators.</p>
<p>For illustrative purpose, we implement two waves of sequential design
on <code>m</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1st wave with 25 steps</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/design.html">design</a></span><span class="op">(</span><span class="va">m</span>, N <span class="op">=</span> <span class="fl">25</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing ... done</span></span>
<span><span class="co">##  * RMSE: 0.487293</span></span>
<span><span class="co">## Iteration 1:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.620583 1.000000</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.388907</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Iteration 18:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.198164 0.195029</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Pruning 1 node(s) in layer 1 ... done</span></span>
<span><span class="co">##  - Re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.052264</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Iteration 25:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.248474 0.034358</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.016924</span></span></code></pre>
<p>After the first wave we see that 1 GP node is removed from the first
layer by automatic pruning of the DGP which leaves only one node in both
the first and second layer of the DGP hierarchy respectively. This helps
accelerate the inference of the DGP emulator in subsequent waves of the
sequential design while maintaining accuracy. We now start the second
wave of the sequential design:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2nd wave with 10 steps</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/design.html">design</a></span><span class="op">(</span><span class="va">m</span>, N <span class="op">=</span> <span class="fl">10</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing ... done</span></span>
<span><span class="co">##  * RMSE: 0.016924</span></span>
<span><span class="co">## Iteration 1:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.092643 0.352432</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.013484</span></span>
<span><span class="co">##   </span></span>
<span><span class="co">##  ...</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Iteration 10:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.901510 0.989878</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.007114</span></span></code></pre>
<p>Finally, we resume the second wave with 10 additional iterations:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2nd wave with 10 additional steps</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/design.html">design</a></span><span class="op">(</span><span class="va">m</span>, N <span class="op">=</span> <span class="fl">10</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, new_wave <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Iteration 11:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.016562 0.966263</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.005308</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  ...</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Iteration 20:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.982806 0.438261</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.002383</span></span></code></pre>
<p>Resuming rather than adding an additional wave can be a useful
feature, particularly for plotting using <code><a href="../reference/draw.html">draw()</a></code>. After the
sequential design is done, we can inspect the enriched design by
applying <code><a href="../reference/draw.html">draw()</a></code> to <code>m</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">'design'</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq_design.png" style="width:100.0%"> It can be
seen from the figure above that most of the added design points
concentrate at the bottom-left corner of the input space where the
simulator <code>f</code> exhibits more variation and thus needs more
data to be well-emulated. We can also visualize the improvement to RMSE
during the sequential design:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">'rmse'</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq_rmse.png" style="width:100.0%"></p>
</div>
<div class="section level2">
<h2 id="comparison-to-dgp-emulators-with-space-filling-designs">Comparison to DGP emulators with space-filling designs<a class="anchor" aria-label="anchor" href="#comparison-to-dgp-emulators-with-space-filling-designs"></a>
</h2>
<p>We build four DGP emulators with static space-filling Latin hypercube
designs (LHD) of size 10, 20, 30, 40, and 50 respectively:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 10</span></span>
<span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y1</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X1</span><span class="op">)</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">Y1</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 20</span></span>
<span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X2</span><span class="op">)</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X2</span>, <span class="va">Y2</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 30</span></span>
<span><span class="va">X3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y3</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X3</span><span class="op">)</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X3</span>, <span class="va">Y3</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 40</span></span>
<span><span class="va">X4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y4</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X4</span><span class="op">)</span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X4</span>, <span class="va">Y4</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 50</span></span>
<span><span class="va">X5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y5</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X5</span><span class="op">)</span></span>
<span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X5</span>, <span class="va">Y5</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>We then extract their RMSEs</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># validation of the DGP emulator with the LHD of size 10</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m1</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse1</span> <span class="op">&lt;-</span> <span class="va">m1</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span></span>
<span><span class="co"># validation of the DGP emulator with the LHD of size 20</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m2</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse2</span> <span class="op">&lt;-</span> <span class="va">m2</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span></span>
<span><span class="co"># validation of the DGP emulator with the LHD of size 30</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m3</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse3</span> <span class="op">&lt;-</span> <span class="va">m3</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span></span>
<span><span class="co"># validation of the DGP emulator with the LHD of size 40</span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m4</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse4</span> <span class="op">&lt;-</span> <span class="va">m4</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span></span>
<span><span class="co"># validation of the DGP emulator with the LHD of size 50</span></span>
<span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m5</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse5</span> <span class="op">&lt;-</span> <span class="va">m5</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span></span>
<span><span class="co"># create a dataframe that stores the RMSEs of the four DGP emulators</span></span>
<span><span class="va">rmse_static</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'N'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span>, <span class="st">'rmse'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rmse1</span>, <span class="va">rmse2</span>, <span class="va">rmse3</span>, <span class="va">rmse4</span>, <span class="va">rmse5</span><span class="op">)</span>, <span class="st">'LHD'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lhd-10'</span>, <span class="st">'lhd-20'</span>, <span class="st">'lhd-30'</span>, <span class="st">'lhd-40'</span>, <span class="st">'lhd-50'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>and add them to the sequential design validation plot (in log-scale)
for comparison:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">'rmse'</span>, log <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rmse_static</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>, y <span class="op">=</span> <span class="va">rmse</span>, group <span class="op">=</span> <span class="va">LHD</span>, shape <span class="op">=</span> <span class="va">LHD</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'#E69F00'</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq_comparison.png" style="width:100.0%"></p>
<p>It can be seen from the plot above that with static space-filling
designs, the quality of an emulator may not be improved as the design
size increases. This is because increasing the size of a space-filling
design may not capture regions where the simulator exhibits more
variation, and thus cause emulators with higher RMSEs than those
constructed through sequential design.</p>
<div class="section level3">
<h3 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h3>
<p>See <a href="https://mingdeyu.github.io/dgpsi-R/dev/articles/seq_design_2.html" class="external-link">Sequential
Design II</a> for the sequential design of a bundle of DGP emulators
with automatic terminations.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ba2018" class="csl-entry">
Ba, Shan, and V. Roshan Joseph. 2018. <em><span>CGP: Composite Gaussian
Process Models</span></em>. <a href="https://CRAN.R-project.org/package=CGP" class="external-link">https://CRAN.R-project.org/package=CGP</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://mingdeyu.github.io" class="external-link">Deyu Ming</a>, <a href="https://experts.exeter.ac.uk/23142-daniel-williamson" class="external-link">Daniel Williamson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
