<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Sequential design and dynamic pruning for the DGP emulator of a non-stationary simulator.
">
<title>Sequential Design I â€¢ dgpsi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sequential Design I">
<meta property="og:description" content="Sequential design and dynamic pruning for the DGP emulator of a non-stationary simulator.
">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dgpsi</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.3.0-9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/dgpsi.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/motorcycle.html">DGP Emulation with the Heteroskedastic Gaussian Likelihood
</a>
    <a class="dropdown-item" href="../articles/linked_DGP.html">Linked (D)GP Emulation</a>
    <a class="dropdown-item" href="../articles/seq_design.html">Sequential Design I</a>
    <a class="dropdown-item" href="../articles/seq_design_2.html">Sequential Design II</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mingdeyu/dgpsi-R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Sequential Design I</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mingdeyu/dgpsi-R/blob/HEAD/vignettes/seq_design.Rmd" class="external-link"><code>vignettes/seq_design.Rmd</code></a></small>
      <div class="d-none name"><code>seq_design.Rmd</code></div>
    </div>

    
    
<p>This vignette shows how to use the package to sequentially enrich the
design for adaptive improvements and pruning of a DGP emulator.</p>
<div class="section level2">
<h2 id="load-the-packages">Load the packages<a class="anchor" aria-label="anchor" href="#load-the-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bertcarnell/lhs" class="external-link">lhs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mingdeyu/dgpsi-R" class="external-link">dgpsi</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="construct-a-synthetic-simulator">Construct a synthetic simulator<a class="anchor" aria-label="anchor" href="#construct-a-synthetic-simulator"></a>
</h2>
<p>We consider a non-stationary synthetic simulator which has a
2-dimensional input with the functional form <span class="citation">(Ba
and Joseph 2018)</span> defined by:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="fl">0.7</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span>,drop<span class="op">=</span><span class="cn">F</span><span class="op">]</span><span class="op">+</span><span class="fl">0.3</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">0.7</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span>,drop<span class="op">=</span><span class="cn">F</span><span class="op">]</span><span class="op">+</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="op">}</span></span></code></pre></div>
<p>Note that to provide the simulator for the sequential design below,
we have defined the above function such that its input <code>x</code>
and output are both matrices. The commands below generate the contour of
the function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">expand_grid</span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">mutate</span><span class="op">(</span><span class="va">dat</span>, f <span class="op">=</span> <span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, fill <span class="op">=</span> <span class="va">f</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"viridis"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq_fct.png"></p>
<p>We can see from the figure above that the synthetic simulator
exhibits more fluctuations on the bottom left of its input space while
in the top-right part the simulator shows little variations.</p>
<p>We now specify a seed with <code><a href="../reference/set_seed.html">set_seed()</a></code> from the package
for reproducibility</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_seed.html">set_seed</a></span><span class="op">(</span><span class="fl">99</span><span class="op">)</span></span></code></pre></div>
<p>and generate an initial design with 5 design points using the maximin
Latin hypercube sampler:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code></pre></div>
<p>To track the qualities of constructed emulators during the sequential
design, we generate a validation dataset:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">validate_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">validate_y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">validate_x</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dgp-emulation-with-sequential-designs">DGP emulation with sequential designs<a class="anchor" aria-label="anchor" href="#dgp-emulation-with-sequential-designs"></a>
</h2>
<p>To start with the sequential design, we initialize a two-layered DGP
emulator (with 2 GP nodes in the first layer and 1 GP node in the second
layer) using the generated initial design:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Auto-generating a 2-layered DGP structure ... done</span></span>
<span><span class="co">## Initializing the DGP emulator ... done</span></span>
<span><span class="co">## Training the DGP emulator: </span></span>
<span><span class="co">## Iteration 500: Layer 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 500/500 [00:01&lt;00:00, 353.90it/s]</span></span>
<span><span class="co">## Imputing ... done</span></span></code></pre>
<p>We then specify the boundaries of input parameters of <code>f</code>
for the sequential design to locate design points to be added:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lim_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">lim_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">lim_1</span>, <span class="va">lim_2</span><span class="op">)</span></span></code></pre></div>
<p>The boundaries of input parameters are defined as a matrix with each
row giving the lower and upper limits of an input parameter. After the
boundaries are specified, we are ready to conduct the sequential design
to adaptively improve the emulator <code>m</code> via
<code><a href="../reference/design.html">design()</a></code>. The function <code><a href="../reference/design.html">design()</a></code> provides a
simple and flexible implementation of sequential designs for DGP
emulators. In this vignette, we only demonstrate its basic usage and
refer users to <code><a href="../reference/design.html">?design</a></code> for more advanced specifications,
e.g., on checkpoints to manually control the design progress and on
schedules to re-fit and validate emulators.</p>
<p>For illustrative purpose, we implement two waves of sequential
designs on <code>m</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1st wave with 25 steps</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/design.html">design</a></span><span class="op">(</span><span class="va">m</span>, N <span class="op">=</span> <span class="fl">25</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing ... done</span></span>
<span><span class="co">##  * RMSE: 0.527337</span></span>
<span><span class="co">## Iteration 1:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.868213 0.037359</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.541914</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Iteration 18:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.341178 0.003477</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Pruning 1 node(s) in layer 1 ... done</span></span>
<span><span class="co">##  - Re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.107640</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Iteration 25:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.168364 0.984091</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.032189</span></span></code></pre>
<p>After the first wave of the sequential design, we see that 1 GP node
is removed from the first layer by the automatic pruning of the DGP
which leaves only one node in both the first and second layer of the DGP
hierarchy respectively. This helps accelerate the inference of the DGP
emulator in subsequent waves of the sequential design while maintaining
accuracy. We now start the second wave of the sequential design:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2nd wave with 10 steps</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/design.html">design</a></span><span class="op">(</span><span class="va">m</span>, N <span class="op">=</span> <span class="fl">10</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing ... done</span></span>
<span><span class="co">##  * RMSE: 0.032189</span></span>
<span><span class="co">## Iteration 1:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.215369 0.384567</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.017259</span></span>
<span><span class="co">##   </span></span>
<span><span class="co">##  ...</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Iteration 10:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.198905 0.873454</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.008300</span></span></code></pre>
<p>Finally, we resume the second wave with 10 additional iterations:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2nd wave with 10 additional steps</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/design.html">design</a></span><span class="op">(</span><span class="va">m</span>, N <span class="op">=</span> <span class="fl">10</span>, limits <span class="op">=</span> <span class="va">lim</span>, f <span class="op">=</span> <span class="va">f</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, new_wave <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Iteration 11:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.977752 0.011568</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.007264</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  ...</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Iteration 20:</span></span>
<span><span class="co">##  - Locating ... done</span></span>
<span><span class="co">##  * Next design point: 0.258375 0.028753</span></span>
<span><span class="co">##  - Updating and re-fitting ... done</span></span>
<span><span class="co">##  - Validating ... done</span></span>
<span><span class="co">##  * RMSE: 0.003784</span></span></code></pre>
<p>After the sequential design is done, we can inspect the enriched
design by applying <code><a href="../reference/draw.html">draw()</a></code> to <code>m</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">'design'</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq_design.png"> It can be seen from the figure
above that most of the added design points concentrate at the
bottom-left corner of the input space where the simulator <code>f</code>
exhibits more variations and thus needs more data to be well-emulated.
We can also visualize the changes of qualities (in terms of RMSEs wrt
the validation dataset) of emulators constructed during the three waves
of sequential designs:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">'rmse'</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq_rmse.png"></p>
</div>
<div class="section level2">
<h2 id="comparison-to-dgp-emulators-with-space-filling-designs">Comparison to DGP emulators with space-filling designs<a class="anchor" aria-label="anchor" href="#comparison-to-dgp-emulators-with-space-filling-designs"></a>
</h2>
<p>We build four DGP emulators with static space-filling Latin hypercube
designs (LHD) of size 10, 20, 30, 40, and 50 respectively:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 10</span></span>
<span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y1</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X1</span><span class="op">)</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">Y1</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 20</span></span>
<span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X2</span><span class="op">)</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X2</span>, <span class="va">Y2</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 30</span></span>
<span><span class="va">X3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y3</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X3</span><span class="op">)</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X3</span>, <span class="va">Y3</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 40</span></span>
<span><span class="va">X4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y4</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X4</span><span class="op">)</span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X4</span>, <span class="va">Y4</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DGP emulator with a LHD of size 50</span></span>
<span><span class="va">X5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lhs/man/maximinLHS.html" class="external-link">maximinLHS</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Y5</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X5</span><span class="op">)</span></span>
<span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">X5</span>, <span class="va">Y5</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>We then extract their RMSEs</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># validation of the DGP emulator with the LHD of size 10</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m1</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse1</span> <span class="op">&lt;-</span> <span class="va">m1</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span></span>
<span><span class="co"># validation of the DGP emulator with the LHD of size 20</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m2</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse2</span> <span class="op">&lt;-</span> <span class="va">m2</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span></span>
<span><span class="co"># validation of the DGP emulator with the LHD of size 30</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m3</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse3</span> <span class="op">&lt;-</span> <span class="va">m3</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span></span>
<span><span class="co"># validation of the DGP emulator with the LHD of size 40</span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m4</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse4</span> <span class="op">&lt;-</span> <span class="va">m4</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span></span>
<span><span class="co"># validation of the DGP emulator with the LHD of size 50</span></span>
<span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m5</span>, x_test <span class="op">=</span> <span class="va">validate_x</span>, y_test <span class="op">=</span> <span class="va">validate_y</span>, verb <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">rmse5</span> <span class="op">&lt;-</span> <span class="va">m5</span><span class="op">$</span><span class="va">oos</span><span class="op">$</span><span class="va">rmse</span></span>
<span><span class="co"># create a dataframe that stores the RMSEs of the four DGP emulators</span></span>
<span><span class="va">rmse_static</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'N'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span>, <span class="st">'rmse'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rmse1</span>, <span class="va">rmse2</span>, <span class="va">rmse3</span>, <span class="va">rmse4</span>, <span class="va">rmse5</span><span class="op">)</span>, <span class="st">'LHD'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lhd-10'</span>, <span class="st">'lhd-20'</span>, <span class="st">'lhd-30'</span>, <span class="st">'lhd-40'</span>, <span class="st">'lhd-50'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>and add them to the sequential design validation plot (in log-scale)
for comparisons:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw.html">draw</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">'rmse'</span>, log <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rmse_static</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>, y <span class="op">=</span> <span class="va">rmse</span>, group <span class="op">=</span> <span class="va">LHD</span>, shape <span class="op">=</span> <span class="va">LHD</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'#E69F00'</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/seq_comparison.png"></p>
<p>It can be seen from the plot above that with static space-filling
designs, the quality of an emulator may not be improved as the design
size increases. This is because increasing the size of a space-filling
design may not capture regions where the simulator exhibits more
variations, and thus cause DGP emulators with higher RMSEs than those
constructed through the sequential design.</p>
<div class="section level3">
<h3 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h3>
<p>See <a href="https://mingdeyu.github.io/dgpsi-R/dev/articles/seq_design_2.html" class="external-link"><code>Sequential Design II</code></a>
for the sequential design of a bundle of DGP emulators with automatic
terminations.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ba2018" class="csl-entry">
Ba, Shan, and V. Roshan Joseph. 2018. <em><span>CGP: Composite Gaussian
Process Models</span></em>. <a href="https://CRAN.R-project.org/package=CGP" class="external-link">https://CRAN.R-project.org/package=CGP</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Deyu Ming, Daniel Williamson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
