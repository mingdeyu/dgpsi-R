<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DGP emulation of the motorcycle accident data.
">
<title>DGP Emulation with the Heteroskedastic Gaussian Likelihood
 • dgpsi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DGP Emulation with the Heteroskedastic Gaussian Likelihood
">
<meta property="og:description" content="DGP emulation of the motorcycle accident data.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dgpsi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/dgpsi.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/motorcycle.html">DGP Emulation with the Heteroskedastic Gaussian Likelihood
</a>
    <a class="dropdown-item" href="../articles/linked_DGP.html">Linked (D)GP Emulation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mingdeyu/dgpsi-R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>DGP Emulation with the Heteroskedastic Gaussian Likelihood
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mingdeyu/dgpsi-R/blob/HEAD/vignettes/motorcycle.Rmd" class="external-link"><code>vignettes/motorcycle.Rmd</code></a></small>
      <div class="d-none name"><code>motorcycle.Rmd</code></div>
    </div>

    
    
<p>This vignette gives a demonstration of the package on emulating the popular motorcycle dataset <span class="citation">(Silverman 1985)</span>.</p>
<div class="section level2">
<h2 id="load-packages-and-data">Load packages and data<a class="anchor" aria-label="anchor" href="#load-packages-and-data"></a>
</h2>
<p>We start by first loading packages and setting up the required Python environment via <code><a href="../reference/init_py.html">init_py()</a></code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mingdeyu/dgpsi-R" class="external-link">dgpsi</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/init_py.html">init_py</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Connecting to Python ... done</span></span>
<span><span class="co">## Importing required Python modules ... done</span></span>
<span><span class="co">## The Python environment for 'dgpsi' is successfully loaded.</span></span></code></pre>
<p><code><a href="../reference/init_py.html">init_py()</a></code> provides an automatic Python environment setup and initialization routine and must be run every time after the package is loaded. We now load the training data points,</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">mcycle</span><span class="op">$</span><span class="va">times</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">mcycle</span><span class="op">$</span><span class="va">accel</span></span></code></pre></div>
<p>scale them,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">(</span><span class="va">X</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Y</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>and plot them:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">'Time'</span>, ylab <span class="op">=</span> <span class="st">'Acceleration'</span>, cex.axis <span class="op">=</span> <span class="fl">1.3</span>, cex.lab <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/motorcycle_data.png"></p>
<p>Before constructing an emulator, we first split a training data set and a testing data set:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_X</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="op">-</span><span class="va">test_idx</span>, , drop <span class="op">=</span> <span class="cn">F</span><span class="op">]</span></span>
<span><span class="va">train_Y</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="op">-</span><span class="va">test_idx</span>, , drop <span class="op">=</span> <span class="cn">F</span><span class="op">]</span></span>
<span><span class="va">test_x</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">test_idx</span>, , drop <span class="op">=</span> <span class="cn">F</span><span class="op">]</span></span>
<span><span class="va">test_y</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="va">test_idx</span>, , drop <span class="op">=</span> <span class="cn">F</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="construct-and-train-a-dgp-emulator">Construct and train a DGP emulator<a class="anchor" aria-label="anchor" href="#construct-and-train-a-dgp-emulator"></a>
</h2>
<p>We consider a three-layered DGP emulator with squared exponential kernels:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_dgp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.html">dgp</a></span><span class="op">(</span><span class="va">train_X</span>, <span class="va">train_Y</span>, depth <span class="op">=</span> <span class="fl">3</span>, lengthscale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, likelihood <span class="op">=</span> <span class="st">"Hetero"</span>, training <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Auto-generating a 3-layered DGP structure ... done</span></span>
<span><span class="co">## Initializing the DGP emulator ... done</span></span></code></pre>
<p>We choose a heteroskedastic Gaussian likelihood by setting <code>likelihood = "Hetero"</code> since the data drawn in the plot show varying noises. <code>lengthscale</code> is set to <code>c(0.5, 0.2)</code> where <code>0.5</code> is the initial lengthscale value for kernel functions of all GP nodes in the first layer and <code>0.2</code> is the initial lengthscale value for kernel functions of all GP nodes in the second layer. We set <code>training = FALSE</code> so <code><a href="../reference/dgp.html">dgp()</a></code> only constructs a DGP structure and we can use <code><a href="../reference/summary.html">summary()</a></code> to check if our specifications for the DGP emulator is correct before proceeding to training:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.html">summary</a></span><span class="op">(</span><span class="va">m_dgp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## +-----------+----------+---------------------+-----------------+---------------+-------------------+------------+-------------------+</span></span>
<span><span class="co">## | Layer No. | Node No. |        Type         | Length-scale(s) |   Variance    |      Nugget       | Input Dims | Global Connection |</span></span>
<span><span class="co">## +-----------+----------+---------------------+-----------------+---------------+-------------------+------------+-------------------+</span></span>
<span><span class="co">## |  Layer 1  |  Node 1  |  GP (Squared-Exp)   |     [0.500]     | 1.000 (fixed) | 1.000e-06 (fixed) |    [1]     |        No         |</span></span>
<span><span class="co">## |  Layer 2  |  Node 1  |  GP (Squared-Exp)   |     [0.200]     |     1.000     | 1.000e-06 (fixed) |    [1]     |        [1]        |</span></span>
<span><span class="co">## |  Layer 2  |  Node 2  |  GP (Squared-Exp)   |     [0.200]     |     1.000     | 1.000e-06 (fixed) |    [1]     |        [1]        |</span></span>
<span><span class="co">## |  Layer 3  |  Node 1  | Likelihood (Hetero) |       NA        |      NA       |        NA         |   [1, 2]   |        NA         |</span></span>
<span><span class="co">## +-----------+----------+---------------------+-----------------+---------------+-------------------+------------+-------------------+</span></span>
<span><span class="co">## 1. 'Input Dims' presents the indices of GP nodes in the feeding layer whose outputs feed into the GP node referred by 'Layer No.' and 'Node No.'.</span></span>
<span><span class="co">## 2. 'Global Connection' indicates the dimensions (i.e., column indices) of the global input data that are used as additional input dimensions to the GP node referred by 'Layer No.' and 'Node No.'.</span></span></code></pre>
<p>For a DGP emulator, we can use <code><a href="../reference/continue.html">continue()</a></code> to invoke the training for the constructed <code>m_dgp</code> instead of re-building everything from scratch by re-running <code><a href="../reference/dgp.html">dgp()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_dgp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/continue.html">continue</a></span><span class="op">(</span><span class="va">m_dgp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Continue the training:</span></span>
<span><span class="co">## Iteration 500: Layer 3: 100%|██████████| 500/500 [00:18&lt;00:00, 27.49it/s]</span></span></code></pre>
<p>For comparison, we also build a GP emulator (by <code><a href="../reference/gp.html">gp()</a></code>) that incorporates homogeneous noises by setting <code>nugget_est = T</code> and the initial nugget value to <span class="math inline">\(0.01\)</span>. We set <code>training</code> to <code>FALSE</code> so we can use <code><a href="../reference/summary.html">summary()</a></code> to check the generated GP structure before training:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gp.html">gp</a></span><span class="op">(</span><span class="va">train_X</span>, <span class="va">train_Y</span>, nugget_est <span class="op">=</span> <span class="cn">T</span>, nugget <span class="op">=</span> <span class="fl">1e-2</span>, training <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/summary.html">summary</a></span><span class="op">(</span><span class="va">m_gp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Auto-generating a GP structure ... done</span></span>
<span><span class="co">## Initializing the GP emulator ... done</span></span>
<span><span class="co">## +-------------+-----------------+----------+--------+------------+</span></span>
<span><span class="co">## | Kernel Fun  | Length-scale(s) | Variance | Nugget | Input Dims |</span></span>
<span><span class="co">## +-------------+-----------------+----------+--------+------------+</span></span>
<span><span class="co">## | Squared-Exp |     [0.200]     |  1.000   | 0.010  |    [1]     |</span></span>
<span><span class="co">## +-------------+-----------------+----------+--------+------------+</span></span>
<span><span class="co">## 'Input Dims' indicates the dimensions (i.e., column indices) of your input data that are used for GP emulator training.</span></span></code></pre>
<p>We now train the GP emulator by re-running the above function with <code>training = TRUE</code>, which is the default setting:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gp.html">gp</a></span><span class="op">(</span><span class="va">train_X</span>, <span class="va">train_Y</span>, nugget_est <span class="op">=</span> <span class="cn">T</span>, nugget <span class="op">=</span> <span class="fl">1e-2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Auto-generating a GP structure ... done</span></span>
<span><span class="co">## Initializing the GP emulator ... done</span></span>
<span><span class="co">## Training the GP emulator ... done</span></span></code></pre>
<p>Before we validate the constructed emulators, we can summarize the trained DGP emulator:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.html">summary</a></span><span class="op">(</span><span class="va">m_dgp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## +-----------+----------+---------------------+-----------------+---------------+-------------------+------------+-------------------+</span></span>
<span><span class="co">## | Layer No. | Node No. |        Type         | Length-scale(s) |   Variance    |      Nugget       | Input Dims | Global Connection |</span></span>
<span><span class="co">## +-----------+----------+---------------------+-----------------+---------------+-------------------+------------+-------------------+</span></span>
<span><span class="co">## |  Layer 1  |  Node 1  |  GP (Squared-Exp)   |     [0.683]     | 1.000 (fixed) | 1.000e-06 (fixed) |    [1]     |        No         |</span></span>
<span><span class="co">## |  Layer 2  |  Node 1  |  GP (Squared-Exp)   |     [0.905]     |     0.833     | 1.000e-06 (fixed) |    [1]     |        [1]        |</span></span>
<span><span class="co">## |  Layer 2  |  Node 2  |  GP (Squared-Exp)   |     [1.962]     |    26.665     | 1.000e-06 (fixed) |    [1]     |        [1]        |</span></span>
<span><span class="co">## |  Layer 3  |  Node 1  | Likelihood (Hetero) |       NA        |      NA       |        NA         |   [1, 2]   |        NA         |</span></span>
<span><span class="co">## +-----------+----------+---------------------+-----------------+---------------+-------------------+------------+-------------------+</span></span>
<span><span class="co">## 1. 'Input Dims' presents the indices of GP nodes in the feeding layer whose outputs feed into the GP node referred by 'Layer No.' and 'Node No.'.</span></span>
<span><span class="co">## 2. 'Global Connection' indicates the dimensions (i.e., column indices) of the global input data that are used as additional input dimensions to the GP node referred by 'Layer No.' and 'Node No.'.</span></span></code></pre>
<p>and GP emulator:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.html">summary</a></span><span class="op">(</span><span class="va">m_gp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## +-------------+-----------------+----------+--------+------------+</span></span>
<span><span class="co">## | Kernel Fun  | Length-scale(s) | Variance | Nugget | Input Dims |</span></span>
<span><span class="co">## +-------------+-----------------+----------+--------+------------+</span></span>
<span><span class="co">## | Squared-Exp |     [0.127]     |  0.728   | 0.321  |    [1]     |</span></span>
<span><span class="co">## +-------------+-----------------+----------+--------+------------+</span></span>
<span><span class="co">## 'Input Dims' indicates the dimensions (i.e., column indices) of your input data that are used for GP emulator training.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="validation">Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h2>
<p>We are now ready to validate both emulators via <code><a href="../reference/validate.html">validate()</a></code> at 20 out-of-sample testing positions generated earlier:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_dgp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m_dgp</span>, <span class="va">test_x</span>, <span class="va">test_y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing the OOS ... done</span></span>
<span><span class="co">## Calculating the OOS ... done</span></span>
<span><span class="co">## Saving results to the slot 'oos' in the dgp object ... done</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">m_gp</span>, <span class="va">test_x</span>, <span class="va">test_y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing the OOS ... done</span></span>
<span><span class="co">## Calculating the OOS ... done</span></span>
<span><span class="co">## Saving results to the slot 'oos' in the gp object ... done</span></span></code></pre>
<p>Note that using [validate()] before plotting can saving computations involved in [plot()] because [validate()] stores validation results in the emulator objects. Finally, we plot the OOS validations for the GP emulator:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">m_gp</span>, <span class="va">test_x</span>, <span class="va">test_y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing ... done</span></span>
<span><span class="co">## Post-processing OOS results ... done</span></span>
<span><span class="co">## Plotting ... done</span></span></code></pre>
<p><img src="images/motorcycle_gp_oos.png"></p>
<p>and for the DGP emulator:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">m_dgp</span>, <span class="va">test_x</span>, <span class="va">test_y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing ... done</span></span>
<span><span class="co">## Post-processing OOS results ... done</span></span>
<span><span class="co">## Plotting ... done</span></span></code></pre>
<p><img src="images/motorcycle_dgp_oos.png"></p>
<p>Note that we still need to provide <code>test_x</code> and <code>test_y</code> to [plot()] even they have already been provided to [validate()]. Otherwise, [plot()] will draw the LOO cross validation plot. The visualizations above show that the DGP emulator gives a better performance than the GP emulator on modeling the heteroskedastic noises embedded in the underlying data set, even though they have quite similar NRMSEs.</p>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-silverman1985" class="csl-entry">
Silverman, Bernhard W. 1985. <span>“Some Aspects of the Spline Smoothing Approach to Non-Parametric Regression Curve Fitting.”</span> <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 47 (1): 1–21.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Deyu Ming, Daniel Williamson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
